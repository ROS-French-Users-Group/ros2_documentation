<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guide de migration depuis ROS 1 &mdash; Documentation ROS 2 documentation </title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.ros.org/en/The-ROS2-Project/Contributing/Migration-Guide.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Guide de migration Python depuis ROS 1" href="Migration-Guide-Python.html" />
    <link rel="prev" title="Guide qualité : assurer la qualité du code" href="Quality-Guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> ROS 2 documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Install-Debians.html">Ubuntu (Debian)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Windows-Install-Binary.html">Windows (binaire)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/RHEL-Install-RPMs.html">RHEL (RPM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Alternatives.html">Alternatives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Development-Setup.html">gratuit (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Install-Binary.html">gratuit (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Windows-Development-Setup.html">Windows (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Development-Setup.html">RHEL (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Install-Binary.html">RHEL (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/macOS-Development-Setup.html">mac OS (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Fedora-Development-Setup.html">Fedora (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Latest-Development-Setup.html">Dernier développement (source)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Maintaining-a-Source-Checkout.html">Maintenir la vérification de la source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Testing.html">Tester avec des binaires de pré-version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/DDS-Implementations.html">Implémentations DDS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-Security-Plugins.html">Plugins de sécurité Connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-University-Eval.html">RTI Connect DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">Éclipse Cyclone DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-GurumNetworks-GurumDDS.html">GurumNetworks GurumDDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-eProsima-Fast-DDS.html">DDS rapide eProsima</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Releases.html">Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Humble-Hawksbill.html">Humble Hawksbill (<code class="docutils literal notranslate"><span class="pre">humble</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Humble-Hawksbill-Complete-Changelog.html">Journal des modifications de Humble Hawksbill</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Foxy-Fitzroy.html">Foxy Fitzroy (<code class="docutils literal notranslate"><span class="pre">foxy</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Rolling-Ridley.html">Rouler Ridley (<code class="docutils literal notranslate"><span class="pre">rouler</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Development.html">Développement Répartition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Iron-Irwini.html">ROS 2 Iron Irwini (nom de code “iron”; mai 2023)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/End-of-Life.html">Distributions en fin de vie</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Galactic-Geochelone.html">Géochelone Galactique (<code class="docutils literal notranslate"><span class="pre">galactique</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Releases/Galactic-Geochelone-Complete-Changelog.html">Journal des modifications de Galactic Geochelone</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html">Eloquent Elusor (``éloquent””)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Dashing-Diademata.html">Dashing Diademata (<code class="docutils literal notranslate"><span class="pre">fringant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Crystal-Clemmys.html">Cristal Clemmys (<code class="docutils literal notranslate"><span class="pre">cristal</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Bouncy-Bolson.html">Bouncy Bolson (<code class="docutils literal notranslate"><span class="pre">rebondissant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Ardent-Apalone.html">Apalone ardent (<code class="docutils literal notranslate"><span class="pre">ardent</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta3-Overview.html">Bêta 3 (<code class="docutils literal notranslate"><span class="pre">r2b3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta2-Overview.html">Bêta 2 (<code class="docutils literal notranslate"><span class="pre">r2b2</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta1-Overview.html">Bêta 1 (<code class="docutils literal notranslate"><span class="pre">Asphalte</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Alpha-Overview.html">Alphas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Process.html">Processus de développement d’une version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials.html">Tutoriels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools.html">Débutant : outils CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Configuring-ROS2-Environment.html">Configuration de l’environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html">Utiliser <code class="docutils literal notranslate"><span class="pre">turtlesim</span></code> et <code class="docutils literal notranslate"><span class="pre">rqt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Nodes/Understanding-ROS2-Nodes.html">Comprendre les nœuds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Topics/Understanding-ROS2-Topics.html">Comprendre les sujets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html">Comprendre les services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html">Comprendre les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html">Comprendre les actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Using-Rqt-Console/Using-Rqt-Console.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">rqt_console</span></code> pour afficher les journaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Launching-Multiple-Nodes/Launching-Multiple-Nodes.html">Nœuds de lancement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html">Enregistrement et lecture de données</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries.html">Débutant : Bibliothèques clientes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Colcon-Tutorial.html">Utiliser <code class="docutils literal notranslate"><span class="pre">colcon</span></code> pour créer des packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html">Créer un espace de travail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html">Création d’un paquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Cpp-Service-And-Client.html">Ecrire un service et un client simples (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Service-And-Client.html">Écrire un service et un client simples (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Custom-ROS2-Interfaces.html">Création de fichiers msg et srv personnalisés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Single-Package-Define-And-Use-Interface.html">Implémentation d’interfaces personnalisées</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Using-Parameters-In-A-Class-CPP.html">Utiliser des paramètres dans une classe (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Using-Parameters-In-A-Class-Python.html">Utiliser des paramètres dans une classe (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Getting-Started-With-Ros2doctor.html">Utiliser <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> pour identifier les problèmes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Pluginlib.html">Créer et utiliser des plugins (C++)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Intermediate.html">Intermédiaire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Rosdep.html">Gestion des dépendances avec rosdep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Creating-an-Action.html">Créer une action</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Writing-an-Action-Server-Client/Cpp.html">Ecriture d’un serveur d’action et d’un client (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Writing-an-Action-Server-Client/Py.html">Ecriture d’un serveur d’action et d’un client (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Composition.html">Composer plusieurs nœuds en un seul processus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Monitoring-For-Parameter-Changes-CPP.html">Surveillance des changements de paramètres (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Launch-Main.html">Lancement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Creating-Launch-Files.html">Création d’un fichier de lancement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Launch-system.html">Intégration des fichiers de lancement dans les packages ROS 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Using-Substitutions.html">Utiliser des substitutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Using-Event-Handlers.html">Utilisation des gestionnaires d’événements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Launch/Using-ROS2-Launch-For-Large-Projects.html">Gestion de grands projets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Tf2-Main.html">tracé</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Introduction-To-Tf2.html">Présentation de <code class="docutils literal notranslate"><span class="pre">tf2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Py.html">Écrire un diffuseur statique (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Cpp.html">Écrire un diffuseur statique (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Py.html">Écrire un diffuseur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Cpp.html">Ecrire un diffuseur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Listener-Py.html">Écrire un écouteur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Writing-A-Tf2-Listener-Cpp.html">Écrire un écouteur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Adding-A-Frame-Py.html">Ajouter un cadre (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Adding-A-Frame-Cpp.html">Ajouter un cadre (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Learning-About-Tf2-And-Time-Py.html">Utiliser le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Learning-About-Tf2-And-Time-Cpp.html">Utilisation du temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Time-Travel-With-Tf2-Py.html">Voyager dans le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Time-Travel-With-Tf2-Cpp.html">Voyager dans le temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Debugging-Tf2-Problems.html">Débogage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Quaternion-Fundamentals.html">Fondamentaux du quaternion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Tf2/Using-Stamped-Datatypes-With-Tf2-Ros-MessageFilter.html">Utiliser des types de données tamponnés avec <code class="docutils literal notranslate"><span class="pre">tf2_ros::MessageFilter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/Testing/Testing-Main.html">Essai</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Testing/CLI.html">Exécution de tests dans ROS 2 à partir de la ligne de commande</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/Testing/Python.html">Écrire des tests de base avec Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/URDF-Main.html">URDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/Building-a-Visual-Robot-Model-with-URDF-from-Scratch.html">Construire un modèle de robot visuel à partir de zéro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/Building-a-Movable-Robot-Model-with-URDF.html">Construire un modèle de robot mobile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model.html">Ajout de propriétés physiques et de collision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/Using-Xacro-to-Clean-Up-a-URDF-File.html">Utiliser Xacro pour nettoyer votre code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Intermediate/URDF/Using-URDF-with-Robot-State-Publisher.html">Utiliser URDF avec <code class="docutils literal notranslate"><span class="pre">robot_state_publisher</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Advanced.html">Avancé</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Topic-Statistics-Tutorial/Topic-Statistics-Tutorial.html">Activation des statistiques de sujet (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Discovery-Server/Discovery-Server.html">Utilisation de Fast DDS Discovery Server comme protocole de découverte [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Allocator-Template-Tutorial.html">Implémentation d’un répartiteur de mémoire personnalisé</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/FastDDS-Configuration.html">Libérer le potentiel du middleware Fast DDS [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Recording-A-Bag-From-Your-Own-Node-CPP.html">Enregistrer un sac à partir d’un nœud (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Recording-A-Bag-From-Your-Own-Node-Py.html">Enregistrer un sac à partir d’un nœud (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Simulators/Simulation-Main.html">Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Simulators/Webots.html">Mise en place d’une simulation de robot (Webots)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Simulators/Gazebo.html">Mise en place d’une simulation de robot (Gazebo)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Advanced/Security/Security-Main.html">Sécurité</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Security/Introducing-ros2-security.html">Mise en place de la sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Security/The-Keystore.html">Comprendre le magasin de clés de sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Security/Security-on-Two.html">Garantir la sécurité sur toutes les machines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Security/Examine-Traffic.html">Examen du trafic réseau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/Advanced/Security/Access-Controls.html">Paramétrage des contrôles d’accès</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Demos.html">Démos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Quality-of-Service.html">Utilisation des paramètres de qualité de service pour les réseaux avec perte</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Managed-Nodes.html">Gestion des nœuds avec des cycles de vie gérés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Intra-Process-Communication.html">Mettre en place une communication intra-process efficace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Rosbag-with-ROS1-Bridge.html">Enregistrement et lecture de données avec <code class="docutils literal notranslate"><span class="pre">rosbag</span></code> en utilisant le pont ROS 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Real-Time-Programming.html">Comprendre la programmation temps réel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/dummy-robot-demo.html">Expérimenter avec un robot factice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Logging-and-logger-configuration.html">Enregistrement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Demos/Content-Filtering-Subscription.html">Création d’un abonnement au filtrage de contenu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/Miscellaneous.html">Divers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Miscellaneous/Deploying-ROS-2-on-IBM-Cloud.html">Déploiement sur IBM Cloud Kubernetes [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Miscellaneous/Eclipse-Oxygen-with-ROS-2-and-rviz2.html">Utiliser Eclipse Oxygen avec <code class="docutils literal notranslate"><span class="pre">rviz2</span></code> [community-contributed]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Miscellaneous/Building-Realtime-rt_preempt-kernel-for-ROS-2.html">Construire un noyau Linux en temps réel [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/Miscellaneous/Building-ROS2-Package-with-eclipse-2021-06.html">Construire un package avec Eclipse 2021-06</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../How-To-Guides.html">Guides pratiques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installation-Troubleshooting.html">Dépannage de l’installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Developing-a-ROS-2-Package.html">Développement d’un package ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Documentation.html">documentation utilisateur ament_cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Python-Documentation.html">documentation utilisateur ament_cmake_python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-files-migration-guide.html">Migration des fichiers de lancement de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-file-different-formats.html">Utilisation de Python, XML et YAML pour les fichiers de lancement ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launching-composable-nodes.html">Utilisation du lancement de ROS 2 pour lancer des nœuds composables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html">Migration des fichiers de paramètres YAML de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Node-arguments.html">Passer des arguments ROS aux nœuds via la ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Sync-Vs-Async.html">Clients de service synchrones ou asynchrones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/DDS-tuning.html">Informations de réglage DDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Overriding-QoS-Policies-For-Recording-And-Playback.html">rosbag2 : Remplacement des politiques de QoS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Working-with-multiple-RMW-implementations.html">Travailler avec plusieurs implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Cross-compilation.html">Compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Releasing/Releasing-a-Package.html">Libérer un paquet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/First-Time-Release.html">Première sortie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Subsequent-Releases.html">Versions ultérieures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Team-Repository.html">Équipe de publication / Référentiel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Track.html">Piste de sortie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Python-Packages.html">Utilisation de packages Python avec ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Port-Plugin-Windows.html">Portage des plugins RQt vers Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Run-2-nodes-in-single-or-separate-docker-containers.html">Exécution de nœuds ROS 2 dans Docker [contribution de la communauté]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Visualizing-ROS-2-Data-With-Foxglove-Studio.html">Visualiser les données ROS 2 avec Foxglove Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Package-maintainer-guide.html">Guide du responsable du paquet ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-a-Custom-Debian-Package.html">Construire un paquet Debian personnalisé</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-ROS-2-with-Tracing-Instrumentation.html">Construire ROS 2 avec instrumentation de traçage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Topics-Services-Actions.html">Sujets vs Services vs Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Variants.html">Utiliser des variantes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros2-param.html">Utilisation de l’outil de ligne de commande <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros1_bridge-Jammy-upstream.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">ros1_bridge</span></code> avec ROS en amont sur Ubuntu 22.04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Disabling-ZeroCopy-loaned-messages.html">Désactivation des messages prêtés sans copie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installing-on-Raspberry-Pi.html">ROS 2 sur Raspberry Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-callback-groups.html">Utilisation des groupes de rappel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install.html">Construire RQt à partir de la source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-MacOS.html">Construire RQt à partir de la source sur macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-Windows10.html">Construire RQt à partir de la source sur Windows 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Concepts.html">Notions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Domain-ID.html">Le ROS_DOMAIN_ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Different-Middleware-Vendors.html">À propos des différents fournisseurs ROS 2 DDS/RTPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Logging.html">À propos de la journalisation et de la configuration de l’enregistreur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html">À propos des paramètres de qualité de service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-Interfaces.html">À propos des interfaces ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Parameters.html">À propos des paramètres dans ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Executors.html">Exécuteurs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Topic-Statistics.html">À propos des statistiques de sujet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Command-Line-Tools.html">Introspection avec des outils en ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-RQt.html">Présentation et utilisation de RQt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Composition.html">À propos de la composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Catment.html">Sur le mélange d’ament et de chaton (catment)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Cross-Compilation.html">À propos de la compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Security.html">À propos de la sécurité ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Tf2.html">À propos de TF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Build-System.html">À propos du système de construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Internal-Interfaces.html">À propos des interfaces ROS 2 internes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Middleware-Implementations.html">À propos des implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contacter</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../The-ROS2-Project.html">Le projet ROS 2</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../Contributing.html">Contribuant</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Developer-Guide.html">Guide du développeur ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="Code-Style-Language-Versions.html">Style de code et versions linguistiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="Quality-Guide.html">Guide qualité : assurer la qualité du code</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Guide de migration depuis ROS 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Migration-Guide-Python.html">Guide de migration Python depuis ROS 1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Build-Farms.html">Fermes de construction ROS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Windows-Tips-and-Tricks.html">Trucs et astuces Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="Contributing-To-ROS-2-Documentation.html">Contribuer à la documentation ROS 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Features.html">Statut des fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Feature-Ideas.html">Idées de fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Roadmap.html">Feuille de route</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ROSCon-Content.html">Pourparlers ROSCon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Governance.html">Gouvernance du projet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Governance/ROS2-TSC-Charter.html">Charte du comité de pilotage technique ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Governance/ROS2-TSC-Intake-process.html">Processus d’admission des candidats ROS 2 TSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Governance/How-To-Start-A-Community-Working-Group.html">Comment démarrer un groupe de travail communautaire</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Marketing.html">Commercialisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Related-Projects.html">Projets liés</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Intel-ROS2-Projects.html">Projets Intel ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Nvidia-ROS2-Projects.html">Projets NVIDIA ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Citations.html">Citations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ROS 2 documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../The-ROS2-Project.html">Le projet ROS 2</a></li>
          <li class="breadcrumb-item"><a href="../Contributing.html">Contribuant</a></li>
      <li class="breadcrumb-item active">Guide de migration depuis ROS 1</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros2/ros2_documentation/blob/rolling/source/The-ROS2-Project/Contributing/Migration-Guide.rst" class="fa fa-github"> Éditer sur GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <div class="section" id="migration-guide-from-ros-1">
<h1>Guide de migration depuis ROS 1<a class="headerlink" href="#migration-guide-from-ros-1" title="Lien permanent vers ce titre"></a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table des matières</p>
<ul class="simple">
<li><p><a class="reference internal" href="#prerequisites" id="id1">Conditions préalables</a></p></li>
<li><p><a class="reference internal" href="#migration-steps" id="id2">Étapes de migration</a></p>
<ul>
<li><p><a class="reference internal" href="#package-manifests" id="id3">Manifestes de package</a></p></li>
<li><p><a class="reference internal" href="#metapackages" id="id4">Métapaquets</a></p></li>
<li><p><a class="reference internal" href="#message-service-and-action-definitions" id="id5">Définitions des messages, des services et des actions</a></p></li>
<li><p><a class="reference internal" href="#build-system" id="id6">Système de construction</a></p></li>
<li><p><a class="reference internal" href="#update-source-code" id="id7">Mettre à jour le code source</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#parameters" id="id8">Paramètres</a></p></li>
<li><p><a class="reference internal" href="#launch-files" id="id9">Lancer des fichiers</a></p></li>
<li><p><a class="reference internal" href="#example-converting-an-existing-ros-1-package-to-use-ros-2" id="id10">Exemple : conversion d’un package ROS 1 existant pour utiliser ROS 2</a></p>
<ul>
<li><p><a class="reference internal" href="#the-ros-1-code" id="id11">Le code ROS 1</a></p></li>
<li><p><a class="reference internal" href="#migrating-to-ros-2" id="id12">Migration vers ROS 2</a></p></li>
<li><p><a class="reference internal" href="#update-scripts" id="id13">Mettre à jour les scripts</a></p></li>
<li><p><a class="reference internal" href="#more-examples-and-tools" id="id14">Plus d’exemples et d’outils</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#licensing" id="id15">Licence</a></p>
<ul>
<li><p><a class="reference internal" href="#changing-the-license" id="id16">Modification de la licence</a></p></li>
</ul>
</li>
</ul>
</div>
<p>Il existe deux types différents de migrations de packages :</p>
<ul class="simple">
<li><p>Migrer le code source d’un package existant de ROS 1 vers ROS 2 avec l’intention qu’une partie importante du code source reste identique ou au moins similaire. Un exemple pour cela pourrait être <a class="reference external" href="https://github.com/ros/pluginlib">pluginlib</a> où le code source est conservé dans différentes branches au sein du même référentiel et généralement des correctifs peuvent être portés entre ces branches si nécessaire.</p></li>
<li><p>Implémentation de la même fonctionnalité ou d’une fonctionnalité similaire d’un package ROS 1 pour ROS 2, mais en supposant que le code source sera significativement différent. Un exemple pour cela pourrait être <a class="reference external" href="https://github.com/ros/ros_comm/tree/melodic-devel/clients/roscpp">roscpp</a> dans ROS 1 et <a class="reference external" href="https://github.com/ros2/rclcpp/tree/rolling/rclcpp">rclcpp</a> dans ROS 2 qui sont des référentiels séparés et ne partagent aucun code.</p></li>
</ul>
<p>Cet article se concentre sur le premier cas et décrit les étapes de haut niveau pour migrer un package ROS 1 vers ROS 2. Il ne vise pas à être une instruction de migration étape par étape et n’est pas considéré comme la « solution » * finale <a href="#id1"><span class="problematic" id="id2">*</span></a>. Les futures versions viseront à rendre la migration plus fluide et moins d’effort jusqu’au point de maintenir un seul paquet de la même branche pour ROS 1 ainsi que ROS 2.</p>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#id1">Conditions préalables</a><a class="headerlink" href="#prerequisites" title="Lien permanent vers ce titre"></a></h2>
<p>Avant de pouvoir migrer un package ROS 1 vers ROS 2, toutes ses dépendances doivent être disponibles dans ROS 2.</p>
</div>
<div class="section" id="migration-steps">
<h2><a class="toc-backref" href="#id2">Étapes de migration</a><a class="headerlink" href="#migration-steps" title="Lien permanent vers ce titre"></a></h2>
<div class="contents local topic" id="sommaire">
<ul class="simple">
<li><p><a class="reference internal" href="#package-manifests" id="id17">Manifestes de package</a></p></li>
<li><p><a class="reference internal" href="#metapackages" id="id18">Métapaquets</a></p></li>
<li><p><a class="reference internal" href="#message-service-and-action-definitions" id="id19">Définitions des messages, des services et des actions</a></p></li>
<li><p><a class="reference internal" href="#build-system" id="id20">Système de construction</a></p></li>
<li><p><a class="reference internal" href="#update-source-code" id="id21">Mettre à jour le code source</a></p></li>
</ul>
</div>
<div class="section" id="package-manifests">
<h3><a class="toc-backref" href="#id17">Manifestes de package</a><a class="headerlink" href="#package-manifests" title="Lien permanent vers ce titre"></a></h3>
<p>ROS 2 ne prend pas en charge le format 1 de la spécification du package, mais uniquement les versions de format plus récentes (2 et supérieures). Par conséquent, le fichier <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> doit être mis à jour au moins au format 2 s’il utilise le format 1. Étant donné que ROS 1 prend en charge tous les formats, il est sûr d’effectuer cette conversion dans le package ROS 1.</p>
<p>Certains packages peuvent avoir des noms différents dans ROS 2, il peut donc être nécessaire de mettre à jour les dépendances en conséquence.</p>
</div>
<div class="section" id="metapackages">
<h3><a class="toc-backref" href="#id18">Métapaquets</a><a class="headerlink" href="#metapackages" title="Lien permanent vers ce titre"></a></h3>
<p>ROS 2 n’a pas de type de package spécial pour les métapackages. Les métapackages peuvent toujours exister en tant que packages réguliers qui ne contiennent que des dépendances d’exécution. Lors de la migration de métapaquets depuis ROS 1, supprimez simplement la balise <code class="docutils literal notranslate"><span class="pre">&lt;metapackage</span> <span class="pre">/&gt;</span></code> dans le manifeste de votre paquet.</p>
</div>
<div class="section" id="message-service-and-action-definitions">
<h3><a class="toc-backref" href="#id19">Définitions des messages, des services et des actions</a><a class="headerlink" href="#message-service-and-action-definitions" title="Lien permanent vers ce titre"></a></h3>
<p>Les fichiers de messages doivent se terminer par <code class="docutils literal notranslate"><span class="pre">.msg</span></code> et doivent être situés dans le sous-dossier <code class="docutils literal notranslate"><span class="pre">msg</span></code>. Les fichiers de service doivent se terminer par <code class="docutils literal notranslate"><span class="pre">.srv</span></code> et doivent être situés dans le sous-dossier <code class="docutils literal notranslate"><span class="pre">srv</span></code>. Les fichiers d’actions doivent se terminer par <code class="docutils literal notranslate"><span class="pre">.action</span></code> et doivent être situés dans le sous-dossier <code class="docutils literal notranslate"><span class="pre">action</span></code>.</p>
<p>Ces fichiers devront peut-être être mis à jour pour se conformer à la <a class="reference external" href="https://design.ros2.org/articles/interface_definition.html">définition de l’interface ROS</a>. Certains types primitifs ont été supprimés et les types <code class="docutils literal notranslate"><span class="pre">duration</span></code> et <code class="docutils literal notranslate"><span class="pre">time</span></code> qui étaient des types intégrés dans ROS 1 ont été remplacés par des définitions de message normales et doivent être utilisés à partir des <a class="reference external" href="https://github.com/ros2/rcl_interfaces/tree/rolling/builtin_interfaces">builtin_interfaces</a> package. De plus, certaines conventions de nommage sont plus strictes que dans ROS 1.</p>
<p>Dans votre <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> :</p>
<ul class="simple">
<li><p>Ajoutez <code class="docutils literal notranslate"><span class="pre">&lt;buildtool_depend&gt;rosidl_default_generators&lt;/buildtool_depend&gt;</span></code>.</p></li>
<li><p>Ajoutez <code class="docutils literal notranslate"><span class="pre">&lt;exec_depend&gt;rosidl_default_runtime&lt;/exec_depend&gt;</span></code>.</p></li>
<li><p>Pour chaque package de message dépendant, ajoutez <code class="docutils literal notranslate"><span class="pre">&lt;depend&gt;message_package&lt;/depend&gt;</span></code>.</p></li>
</ul>
<p>Dans votre <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> :</p>
<ul class="simple">
<li><p>Commencez par activer C++14</p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Ajouter <code class="docutils literal notranslate"><span class="pre">find_package(rosidl_default_generators</span> <span class="pre">OBLIGATOIRE)</span></code></p></li>
<li><p>Pour chaque paquet de message dépendant, ajoutez <code class="docutils literal notranslate"><span class="pre">find_package(message_package</span> <span class="pre">REQUIRED)</span></code> et remplacez l’appel de la fonction CMake à <code class="docutils literal notranslate"><span class="pre">generate_messages</span></code> par <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code>.</p></li>
</ul>
<p>Cela remplacera la liste <code class="docutils literal notranslate"><span class="pre">add_message_files</span></code> et <code class="docutils literal notranslate"><span class="pre">add_service_files</span></code> de tous les fichiers de messages et de services, qui peuvent être supprimés.</p>
</div>
<div class="section" id="build-system">
<h3><a class="toc-backref" href="#id20">Système de construction</a><a class="headerlink" href="#build-system" title="Lien permanent vers ce titre"></a></h3>
<p>Le système de construction dans ROS 2 s’appelle <a class="reference external" href="https://design.ros2.org/articles/ament.html">ament</a> et l’outil de construction est <span class="xref std std-doc">colcon</span>. Ament est construit sur CMake : <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> fournit des fonctions CMake pour faciliter l’écriture des fichiers <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.</p>
<div class="section" id="build-tool">
<h4>Outil de construction<a class="headerlink" href="#build-tool" title="Lien permanent vers ce titre"></a></h4>
<p>Au lieu d’utiliser <code class="docutils literal notranslate"><span class="pre">catkin_make</span></code>, <code class="docutils literal notranslate"><span class="pre">catkin_make_isolated</span></code> ou <code class="docutils literal notranslate"><span class="pre">catkin</span> <span class="pre">build</span></code> ROS 2 utilise l’outil de ligne de commande <a class="reference external" href="https://design.ros2.org/articles/build_tool.html">colcon</a> pour construire et installer un ensemble de packages.</p>
</div>
<div class="section" id="pure-python-package">
<h4>Paquet Python pur<a class="headerlink" href="#pure-python-package" title="Lien permanent vers ce titre"></a></h4>
<p>Si le package ROS 1 utilise CMake uniquement pour appeler le fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> et ne contient rien à côté du code Python (par exemple, aucun message, service, etc.), il doit être converti en un package Python pur dans ROS 2 :</p>
<ul>
<li><p>Mettez à jour ou ajoutez le type de build dans le fichier <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_type&gt;</span>ament_python<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
</li>
<li><p>Supprimez le fichier <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p></li>
<li><p>Mettez à jour le fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> pour qu’il devienne un script d’installation Python standard</p></li>
</ul>
<p>ROS 2 ne prend en charge que Python 3. Bien que chaque package puisse choisir de prendre également en charge Python 2, il doit appeler des exécutables avec Python 3 s’il utilise une API fournie par d’autres packages ROS 2.</p>
</div>
<div class="section" id="update-the-cmakelists-txt-to-use-ament-cmake">
<h4>Mettez à jour le <em>CMakeLists.txt</em> pour utiliser <em>ament_cmake</em><a class="headerlink" href="#update-the-cmakelists-txt-to-use-ament-cmake" title="Lien permanent vers ce titre"></a></h4>
<p>Appliquez les modifications suivantes pour utiliser <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> au lieu de <code class="docutils literal notranslate"><span class="pre">catkin</span></code> :</p>
<ul>
<li><p>Définissez le type de construction dans la section d’exportation du fichier <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
</li>
<li><p>Remplacez l’invocation <code class="docutils literal notranslate"><span class="pre">find_package</span></code> par <code class="docutils literal notranslate"><span class="pre">catkin</span></code> et les <code class="docutils literal notranslate"><span class="pre">COMPONENTS</span></code> par :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">component1</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c"># ...</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">componentN</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Déplacez et mettez à jour l’invocation <code class="docutils literal notranslate"><span class="pre">catkin_package</span></code> avec :</p>
<ul class="simple">
<li><p>Invoquez <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> à la place, mais <strong>après</strong> que toutes les cibles aient été enregistrées.</p></li>
<li><p>Le seul argument valide pour <a class="reference external" href="https://github.com/ament/ament_cmake/blob/rolling/ament_cmake_core/cmake/core/ament_package.cmake">ament_package</a> est <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS</span></code>. Tous les autres arguments sont couverts par des fonctions séparées qui doivent toutes être invoquées <em>avant</em> <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> :</p>
<ul>
<li><p>Au lieu de passer <code class="docutils literal notranslate"><span class="pre">CATKIN_DEPENDS</span> <span class="pre">...</span></code> appelez <code class="docutils literal notranslate"><span class="pre">ament_export_dependencies(...)</span></code> avant.</p></li>
<li><p>Au lieu de passer <code class="docutils literal notranslate"><span class="pre">INCLUDE_DIRS</span> <span class="pre">...</span></code> appelez <code class="docutils literal notranslate"><span class="pre">ament_export_include_directories(...)</span></code> avant.</p></li>
<li><p>Au lieu de passer <code class="docutils literal notranslate"><span class="pre">LIBRARIES</span> <span class="pre">...</span></code>, appelez <code class="docutils literal notranslate"><span class="pre">ament_export_libraries(...)</span></code> avant.</p></li>
</ul>
</li>
<li><p><strong>TODO document ament_export_targets (``ament_export_interfaces`` dans Eloquent et versions antérieures) ?</strong></p></li>
</ul>
</li>
<li><p>Remplacez l’invocation de <code class="docutils literal notranslate"><span class="pre">add_message_files</span></code>, <code class="docutils literal notranslate"><span class="pre">add_service_files</span></code> et <code class="docutils literal notranslate"><span class="pre">generate_messages</span></code> par <code class="xref any docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> __.</p>
<ul>
<li><p>Le premier argument est le <code class="docutils literal notranslate"><span class="pre">target_name</span></code>. Si vous construisez une seule bibliothèque, c’est <code class="docutils literal notranslate"><span class="pre">${PROJECT_NAME}</span></code></p></li>
<li><p>Suivi de la liste des noms de fichiers de messages, par rapport à la racine du package.</p>
<ul class="simple">
<li><p>Si vous utilisez la liste des noms de fichiers plusieurs fois, il est recommandé de composer une liste de fichiers de messages et de transmettre la liste à la fonction pour plus de clarté.</p></li>
</ul>
</li>
<li><p>L’argument final du mot-clé à valeurs multiples fpr <code class="docutils literal notranslate"><span class="pre">generate_messages</span></code> est <code class="docutils literal notranslate"><span class="pre">DEPENDENCIES</span></code> qui nécessite la liste des packages de messages dépendants.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">rosidl_generate_interfaces</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span>
<span class="w">  </span><span class="o">${</span><span class="nv">msg_files</span><span class="o">}</span>
<span class="w">  </span><span class="s">DEPENDENCIES</span><span class="w"> </span><span class="s">std_msgs</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Supprimez toutes les occurrences de l”<em>espace de développement</em>. Les variables CMake associées comme <code class="docutils literal notranslate"><span class="pre">CATKIN_DEVEL_PREFIX</span></code> n’existent plus.</p>
<ul class="simple">
<li><p>Les arguments <code class="docutils literal notranslate"><span class="pre">CATKIN_DEPENDS</span></code> et <code class="docutils literal notranslate"><span class="pre">DEPENDS</span></code> sont passés à la nouvelle fonction <a class="reference external" href="https://github.com/ament/ament_cmake/blob/rolling/ament_cmake_export_dependencies/cmake/ament_export_dependencies.cmake">ament_export_dependencies</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_BIN_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">bin</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_INCLUDE_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">inclure</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_LIB_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">lib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_LIBEXEC_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">lib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_SHARE_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">partager</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_BIN_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">lib/${PROJECT_NAME}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_INCLUDE_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">include/${PROJECT_NAME}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_LIB_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">lib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_SHARE_DESTINATION</span></code> : <code class="docutils literal notranslate"><span class="pre">partager/${PROJECT_NAME}</span></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="unit-tests">
<h4>Tests unitaires<a class="headerlink" href="#unit-tests" title="Lien permanent vers ce titre"></a></h4>
<p>Si vous utilisez gtest :</p>
<p>Remplacez <code class="docutils literal notranslate"><span class="pre">CATKIN_ENABLE_TESTING</span></code> par <code class="docutils literal notranslate"><span class="pre">BUILD_TESTING</span></code>. Remplacez <code class="docutils literal notranslate"><span class="pre">catkin_add_gtest</span></code> par <code class="docutils literal notranslate"><span class="pre">ament_add_gtest</span></code>.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">-   if (CATKIN_ENABLE_TESTING)</span>
<span class="gd">-     find_package(GTest REQUIRED)  # or rostest</span>
<span class="gd">-     include_directories(${GTEST_INCLUDE_DIRS})</span>
<span class="gd">-     catkin_add_gtest(${PROJECT_NAME}-some-test src/test/some_test.cpp)</span>
<span class="gd">-     target_link_libraries(${PROJECT_NAME}-some-test</span>
<span class="gd">-       ${PROJECT_NAME}_some_dependency</span>
<span class="gd">-       ${catkin_LIBRARIES}</span>
<span class="gd">-       ${GTEST_LIBRARIES})</span>
<span class="gd">-   endif()</span>
<span class="gi">+   if (BUILD_TESTING)</span>
<span class="gi">+     find_package(ament_cmake_gtest REQUIRED)</span>
<span class="gi">+     ament_add_gtest(${PROJECT_NAME}-some-test src/test/test_something.cpp)</span>
<span class="gi">+     ament_target_dependencies(${PROJECT_NAME)-some-test</span>
<span class="gi">+       &quot;rclcpp&quot;</span>
<span class="gi">+       &quot;std_msgs&quot;)</span>
<span class="gi">+     target_link_libraries(${PROJECT_NAME}-some-test</span>
<span class="gi">+       ${PROJECT_NAME}_some_dependency)</span>
<span class="gi">+   endif()</span>
</pre></div>
</div>
<p>Ajoutez <code class="docutils literal notranslate"><span class="pre">&lt;test_depend&gt;ament_cmake_gtest&lt;/test_depend&gt;</span></code> à votre <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">-   &lt;test_depend&gt;rostest&lt;/test_depend&gt;</span>
<span class="gi">+   &lt;test_depend&gt;ament_cmake_gtest&lt;/test_depend&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="linters">
<h4>Linters<a class="headerlink" href="#linters" title="Lien permanent vers ce titre"></a></h4>
<p>Dans ROS 2, nous travaillons pour maintenir un code propre en utilisant des linters. Les styles pour les différentes langues sont définis dans notre <code class="xref any docutils literal notranslate"><span class="pre">Guide</span> <span class="pre">du</span> <span class="pre">développeur</span></code>.</p>
<p>Si vous démarrez un projet à partir de zéro, il est recommandé de suivre le guide de style et d’activer les tests unitaires automatiques de linter en ajoutant ces lignes juste en dessous de <code class="docutils literal notranslate"><span class="pre">if(BUILD_TESTING)</span></code> (jusqu’à l’alpha 5, c’était <code class="docutils literal notranslate"><span class="pre">AMENT_ENABLE_TESTING</span></code>) .</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_lint_auto</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_lint_auto_find_test_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p>Vous devrez également ajouter les dépendances suivantes à votre <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test_depend&gt;</span>ament_lint_auto<span class="nt">&lt;/test_depend&gt;</span>
<span class="nt">&lt;test_depend&gt;</span>ament_lint_common<span class="nt">&lt;/test_depend&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="continue-to-use-catkin-in-cmake">
<h4>Continuez à utiliser <code class="docutils literal notranslate"><span class="pre">catkin</span></code> dans CMake<a class="headerlink" href="#continue-to-use-catkin-in-cmake" title="Lien permanent vers ce titre"></a></h4>
<p>ROS 2 utilise ament comme système de construction mais pour la rétrocompatibilité, ROS 2 a un paquet appelé <code class="docutils literal notranslate"><span class="pre">catkin</span></code> qui fournit presque la même API que catkin dans ROS 1. Afin d’utiliser cette API de rétrocompatibilité, le <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt`</span> <span class="pre">`</span> <span class="pre">ne</span> <span class="pre">doit</span> <span class="pre">être</span> <span class="pre">mis</span> <span class="pre">à</span> <span class="pre">jour</span> <span class="pre">que</span> <span class="pre">pour</span> <span class="pre">appeler</span> <span class="pre">la</span> <span class="pre">fonction</span> <span class="pre">``catkin_ament_package()</span></code> <em>après</em> toutes les cibles.</p>
<p><strong>REMARQUE : Ceci n’a pas encore été implémenté et n’est qu’une idée pour le moment. En raison du nombre de modifications liées aux dépendances, il n’a pas encore été décidé si cette API de compatibilité est suffisamment utile pour justifier l’effort.</strong></p>
</div>
</div>
<div class="section" id="update-source-code">
<h3><a class="toc-backref" href="#id21">Mettre à jour le code source</a><a class="headerlink" href="#update-source-code" title="Lien permanent vers ce titre"></a></h3>
<div class="section" id="messages-services-and-actions">
<h4>Messages, services et actions<a class="headerlink" href="#messages-services-and-actions" title="Lien permanent vers ce titre"></a></h4>
<p>L’espace de noms des messages, services et actions ROS 2 utilise un sous-espace de noms (<code class="docutils literal notranslate"><span class="pre">msg</span></code>, <code class="docutils literal notranslate"><span class="pre">srv</span></code> ou <code class="docutils literal notranslate"><span class="pre">action</span></code>, respectivement) après le nom du package. Par conséquent, une inclusion ressemble à : <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;my_interfaces/msg/my_message.hpp&gt;</span></code>. Le type C++ est alors nommé : <code class="docutils literal notranslate"><span class="pre">my_interfaces::msg::MyMessage</span></code>.</p>
<p>Les types de pointeurs partagés sont fournis en tant que typedefs dans les structures de message : <code class="docutils literal notranslate"><span class="pre">my_interfaces::msg::MyMessage::SharedPtr</span></code> ainsi que <code class="docutils literal notranslate"><span class="pre">my_interfaces::msg::MyMessage::ConstSharedPtr</span></code>.</p>
<p>Pour plus de détails, veuillez consulter l’article sur les <a class="reference external" href="https://design.ros2.org/articles/generated_interfaces_cpp.html">interfaces C++ générées</a>.</p>
<p>La migration nécessite la modification d’includes par :</p>
<ul class="simple">
<li><p>insertion du sous-dossier <code class="docutils literal notranslate"><span class="pre">msg</span></code> entre le nom du package et le type de données du message</p></li>
<li><p>changer le nom de fichier inclus de CamelCase pour souligner la séparation</p></li>
<li><p>passage de <code class="docutils literal notranslate"><span class="pre">*.h</span></code> à <code class="docutils literal notranslate"><span class="pre">*.hpp</span></code></p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ROS 1 style is in comments, ROS 2 follows, uncommented.</span>
<span class="c1">// # include &lt;geometry_msgs/PointStamped.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;geometry_msgs/msg/point_stamped.hpp&gt;</span>

<span class="c1">// geometry_msgs::PointStamped point_stamped;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">PointStamped</span><span class="w"> </span><span class="n">point_stamped</span><span class="p">;</span>
</pre></div>
</div>
<p>La migration nécessite du code pour insérer l’espace de noms <code class="docutils literal notranslate"><span class="pre">msg</span></code> dans toutes les instances.</p>
</div>
<div class="section" id="use-of-service-objects">
<h4>Utilisation des objets de service<a class="headerlink" href="#use-of-service-objects" title="Lien permanent vers ce titre"></a></h4>
<p>Les rappels de service dans ROS 2 n’ont pas de valeurs de retour booléennes. Au lieu de renvoyer false en cas d’échec, il est recommandé de lever des exceptions.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ROS 1 style is in comments, ROS 2 follows, uncommented.</span>
<span class="c1">// #include &quot;nav_msgs/GetMap.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;nav_msgs/srv/get_map.hpp&quot;</span>

<span class="c1">// bool service_callback(</span>
<span class="c1">//   nav_msgs::GetMap::Request &amp; request,</span>
<span class="c1">//   nav_msgs::GetMap::Response &amp; response)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">service_callback</span><span class="p">(</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">nav_msgs</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">GetMap</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">nav_msgs</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">GetMap</span><span class="o">::</span><span class="n">Response</span><span class="o">&gt;</span><span class="w"> </span><span class="n">response</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="w">  </span><span class="c1">// return true;  // or false for failure</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="usages-of-ros-time">
<h4>Usages de ros::Time<a class="headerlink" href="#usages-of-ros-time" title="Lien permanent vers ce titre"></a></h4>
<p>Pour les utilisations de <code class="docutils literal notranslate"><span class="pre">ros::Time</span></code> :</p>
<ul class="simple">
<li><p>Remplacez toutes les instances de <code class="docutils literal notranslate"><span class="pre">ros::Time</span></code> par <code class="docutils literal notranslate"><span class="pre">rclcpp::Time</span></code></p></li>
<li><p>Si vos messages ou votre code utilisent std_msgs::Time :</p>
<ul>
<li><p>Convertir toutes les instances de std_msgs::Time en builtin_interfaces::msg::Time</p></li>
<li><p>Convertissez tous les <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&quot;std_msgs/time.h</span></code> en <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&quot;builtin_interfaces/msg/time.hpp&quot;</span></code></p></li>
<li><p>Convertissez toutes les instances utilisant le champ std_msgs::Time <code class="docutils literal notranslate"><span class="pre">nsec</span></code> en builtin_interfaces::msg::Time field <code class="docutils literal notranslate"><span class="pre">nanosec</span></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="usages-of-ros-rate">
<h4>Usages de ros :: Rate<a class="headerlink" href="#usages-of-ros-rate" title="Lien permanent vers ce titre"></a></h4>
<p>Il existe un objet équivalent de type <code class="docutils literal notranslate"><span class="pre">rclcpp::Rate</span></code> qui est essentiellement un remplacement de <code class="docutils literal notranslate"><span class="pre">ros::Rate</span></code>.</p>
</div>
<div class="section" id="ros-client-library">
<h4>bibliothèque cliente ROS<a class="headerlink" href="#ros-client-library" title="Lien permanent vers ce titre"></a></h4>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="Migration-Guide-Python.html">Guide de migration Python depuis ROS 1</a></li>
</ul>
</div>
<p><strong>REMARQUE : Autres à écrire</strong></p>
</div>
<div class="section" id="boost">
<h4>Augmenter<a class="headerlink" href="#boost" title="Lien permanent vers ce titre"></a></h4>
<p>Une grande partie des fonctionnalités précédemment fournies par Boost ont été intégrées dans la bibliothèque standard C++. En tant que tel, nous aimerions tirer parti des nouvelles fonctionnalités de base et éviter la dépendance au boost dans la mesure du possible.</p>
<div class="section" id="shared-pointers">
<h5>Pointeurs partagés<a class="headerlink" href="#shared-pointers" title="Lien permanent vers ce titre"></a></h5>
<p>Pour basculer les pointeurs partagés de boost vers le C++ standard, remplacez les instances de :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/shared_ptr.hpp&gt;</span></code> avec <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;mémoire&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::shared_ptr</span></code> avec <code class="docutils literal notranslate"><span class="pre">std::shared_ptr</span></code></p></li>
</ul>
<p>Il peut également y avoir des variantes telles que <code class="docutils literal notranslate"><span class="pre">weak_ptr</span></code> que vous souhaitez également convertir.</p>
<p>Il est également recommandé d’utiliser <code class="docutils literal notranslate"><span class="pre">using</span></code> au lieu de <code class="docutils literal notranslate"><span class="pre">typedef</span></code>. <code class="docutils literal notranslate"><span class="pre">using</span></code> a la capacité de mieux fonctionner dans la logique basée sur des modèles. Pour plus de détails <a class="reference external" href="https://stackoverflow.com/questions/10747810/what-is-the-difference-between-typedef-and-using-in-c11">voir ici</a></p>
</div>
<div class="section" id="thread-mutexes">
<h5>Thread/Mutex<a class="headerlink" href="#thread-mutexes" title="Lien permanent vers ce titre"></a></h5>
<p>Une autre partie courante de boost utilisée dans les bases de code ROS sont les mutex dans <code class="docutils literal notranslate"><span class="pre">boost::thread</span></code>.</p>
<ul class="simple">
<li><p>Remplacez <code class="docutils literal notranslate"><span class="pre">boost::mutex::scoped_lock</span></code> par <code class="docutils literal notranslate"><span class="pre">std::unique_lock&lt;std::mutex&gt;</span></code></p></li>
<li><p>Remplacez <code class="docutils literal notranslate"><span class="pre">boost::mutex</span></code> par <code class="docutils literal notranslate"><span class="pre">std::mutex</span></code></p></li>
<li><p>Remplacez <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/thread/mutex.hpp&gt;</span></code> par <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;mutex&gt;</span></code></p></li>
</ul>
</div>
<div class="section" id="unordered-map">
<h5>Carte non ordonnée<a class="headerlink" href="#unordered-map" title="Lien permanent vers ce titre"></a></h5>
<p>Remplacer:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/unordered_map.hpp&gt;</span></code> avec <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;unordered_map&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::unordered_map</span></code> avec <code class="docutils literal notranslate"><span class="pre">std::unordered_map</span></code></p></li>
</ul>
</div>
<div class="section" id="function">
<h5>fonction<a class="headerlink" href="#function" title="Lien permanent vers ce titre"></a></h5>
<p>Remplacer:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/function.hpp&gt;</span></code> avec <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;fonctionnel&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::fonction</span></code> avec <code class="docutils literal notranslate"><span class="pre">std::fonction</span></code></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="parameters">
<h2><a class="toc-backref" href="#id8">Paramètres</a><a class="headerlink" href="#parameters" title="Lien permanent vers ce titre"></a></h2>
<p>Dans ROS 1, les paramètres sont associés à un serveur central qui permettait de récupérer les paramètres au moment de l’exécution grâce à l’utilisation des API réseau. Dans ROS 2, les paramètres sont associés par nœud et sont configurables lors de l’exécution avec les services ROS.</p>
<ul class="simple">
<li><p>Voir <a class="reference external" href="https://design.ros2.org/articles/ros_parameters.html">Document de conception de paramètres ROS 2</a> pour plus de détails sur le modèle de système.</p></li>
<li><p>Voir <a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html"><span class="doc">Utilisation de la CLI ROS 2</span></a> pour une meilleure compréhension du fonctionnement des outils CLI et de ses différences avec l’outillage ROS 1.</p></li>
<li><p>Voir <a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html"><span class="doc">Migration des fichiers de paramètres YAML de ROS 1 vers ROS 2</span></a> pour voir comment les fichiers de paramètres YAML sont analysés dans ROS 2 et leurs différences avec l’implémentation de ROS.</p></li>
</ul>
</div>
<div class="section" id="launch-files">
<h2><a class="toc-backref" href="#id9">Lancer des fichiers</a><a class="headerlink" href="#launch-files" title="Lien permanent vers ce titre"></a></h2>
<p>Alors que les fichiers de lancement dans ROS 1 sont toujours spécifiés à l’aide de fichiers <a class="reference external" href="https://wiki.ros.org/roslaunch/XML">.xml</a>, ROS 2 prend en charge les scripts Python pour permettre plus de flexibilité (voir <a class="reference external" href="https://github.com/ros2/launch/tree/rolling/launch">package de lancement</a>) ainsi que des fichiers XML et YAML. Voir <a class="reference internal" href="../../How-To-Guides/Launch-files-migration-guide.html"><span class="doc">tutoriel séparé</span></a> sur la migration des fichiers de lancement de ROS 1 vers ROS 2.</p>
</div>
<div class="section" id="example-converting-an-existing-ros-1-package-to-use-ros-2">
<h2><a class="toc-backref" href="#id10">Exemple : conversion d’un package ROS 1 existant pour utiliser ROS 2</a><a class="headerlink" href="#example-converting-an-existing-ros-1-package-to-use-ros-2" title="Lien permanent vers ce titre"></a></h2>
<p>Disons que nous avons un package ROS 1 simple appelé <code class="docutils literal notranslate"><span class="pre">talker</span></code> qui utilise <code class="docutils literal notranslate"><span class="pre">roscpp</span></code> dans un nœud, appelé <code class="docutils literal notranslate"><span class="pre">talker</span></code>. Ce paquet se trouve dans un espace de travail catkin, situé dans <code class="docutils literal notranslate"><span class="pre">~/ros1_talker</span></code>.</p>
<div class="section" id="the-ros-1-code">
<h3><a class="toc-backref" href="#id11">Le code ROS 1</a><a class="headerlink" href="#the-ros-1-code" title="Lien permanent vers ce titre"></a></h3>
<p>Voici la disposition du répertoire de notre espace de travail catkin :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/ros1_talker
$<span class="w"> </span>find<span class="w"> </span>.
.
./src
./src/talker
./src/talker/package.xml
./src/talker/CMakeLists.txt
./src/talker/talker.cpp
</pre></div>
</div>
<p>Voici le contenu de ces trois fichiers :</p>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/paquet.xml</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;package&gt;</span>
<span class="w">  </span><span class="nt">&lt;name&gt;</span>talker<span class="nt">&lt;/name&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
<span class="w">  </span><span class="nt">&lt;description&gt;</span>talker<span class="nt">&lt;/description&gt;</span>
<span class="w">  </span><span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;gerkey@osrfoundation.org&quot;</span><span class="nt">&gt;</span>Brian<span class="w"> </span>Gerkey<span class="nt">&lt;/maintainer&gt;</span>
<span class="w">  </span><span class="nt">&lt;license&gt;</span>Apache<span class="w"> </span>2.0<span class="nt">&lt;/license&gt;</span>
<span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>catkin<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_depend&gt;</span>roscpp<span class="nt">&lt;/build_depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_depend&gt;</span>std_msgs<span class="nt">&lt;/build_depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;run_depend&gt;</span>roscpp<span class="nt">&lt;/run_depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;run_depend&gt;</span>std_msgs<span class="nt">&lt;/run_depend&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/CMakeLists.txt</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">2.8.3</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">talker</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">catkin</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">roscpp</span><span class="w"> </span><span class="s">std_msgs</span><span class="p">)</span>
<span class="nb">catkin_package</span><span class="p">()</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">catkin_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="s">talker.cpp</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="o">${</span><span class="nv">catkin_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">RUNTIME</span><span class="w"> </span><span class="s">DESTINATION</span><span class="w"> </span><span class="o">${</span><span class="nv">CATKIN_PACKAGE_BIN_DESTINATION</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/talker.cpp</span></code> :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ros/ros.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/String.h&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;talker&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="n">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">    </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;hello world &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="w">    </span><span class="n">ROS_INFO</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="n">chatter_pub</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="w">    </span><span class="n">ros</span><span class="o">::</span><span class="n">spinOnce</span><span class="p">();</span>
<span class="w">    </span><span class="n">loop_rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="building-the-ros-1-code">
<h4>Construire le code ROS 1<a class="headerlink" href="#building-the-ros-1-code" title="Lien permanent vers ce titre"></a></h4>
<p>Nous créons un fichier de configuration d’environnement (dans ce cas pour Jade en utilisant bash), puis nous construisons notre paquet en utilisant <code class="docutils literal notranslate"><span class="pre">catkin_make</span> <span class="pre">install</span></code> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>/opt/ros/jade/setup.bash
<span class="nb">cd</span><span class="w"> </span>~/ros1_talker
catkin_make<span class="w"> </span>install
</pre></div>
</div>
</div>
<div class="section" id="running-the-ros-1-node">
<h4>Exécution du nœud ROS 1<a class="headerlink" href="#running-the-ros-1-node" title="Lien permanent vers ce titre"></a></h4>
<p>S’il n’y en a pas déjà un en cours d’exécution, nous lançons un <code class="docutils literal notranslate"><span class="pre">roscore</span></code>, en commençant par rechercher le fichier de configuration à partir de notre arbre d’installation <code class="docutils literal notranslate"><span class="pre">catkin</span></code> (le fichier de configuration du système à <code class="docutils literal notranslate"><span class="pre">/opt/ros/jade/setup.bash</span></code> fonctionnerait aussi ici):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>~/ros1_talker/install/setup.bash
roscore
</pre></div>
</div>
<p>Dans un autre shell, nous exécutons le nœud à partir de l’espace d’installation <code class="docutils literal notranslate"><span class="pre">catkin</span></code> en utilisant <code class="docutils literal notranslate"><span class="pre">rosrun</span></code>, en recherchant d’abord le fichier de configuration (dans ce cas, il doit s’agir de celui de notre espace de travail) :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>~/ros1_talker/install/setup.bash
rosrun<span class="w"> </span>talker<span class="w"> </span>talker
</pre></div>
</div>
</div>
</div>
<div class="section" id="migrating-to-ros-2">
<h3><a class="toc-backref" href="#id12">Migration vers ROS 2</a><a class="headerlink" href="#migrating-to-ros-2" title="Lien permanent vers ce titre"></a></h3>
<p>Commençons par créer un nouvel espace de travail dans lequel travailler :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>~/ros2_talker
<span class="nb">cd</span><span class="w"> </span>~/ros2_talker
</pre></div>
</div>
<p>Nous allons copier l’arborescence source de notre package ROS 1 dans cet espace de travail, où nous pourrons le modifier :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>src
cp<span class="w"> </span>-a<span class="w"> </span>~/ros1_talker/src/talker<span class="w"> </span>src
</pre></div>
</div>
<p>Nous allons maintenant modifier le code C++ dans le nœud. La bibliothèque ROS 2 C++, appelée <code class="docutils literal notranslate"><span class="pre">rclcpp</span></code>, fournit une API différente de celle fournie par <code class="docutils literal notranslate"><span class="pre">roscpp</span></code>. Les concepts sont très similaires entre les deux bibliothèques, ce qui rend les modifications raisonnablement simples à effectuer.</p>
<div class="section" id="included-headers">
<h4>En-têtes inclus<a class="headerlink" href="#included-headers" title="Lien permanent vers ce titre"></a></h4>
<p>Au lieu de <code class="docutils literal notranslate"><span class="pre">ros/ros.h</span></code>, qui nous a donné accès à l’API de la bibliothèque <code class="docutils literal notranslate"><span class="pre">roscpp</span></code>, nous devons inclure <code class="docutils literal notranslate"><span class="pre">rclcpp/rclcpp.hpp</span></code>, qui nous donne accès à la <a href="#id1"><span class="problematic" id="id2">``</span></a>rclcpp `` API de la bibliothèque :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//#include &quot;ros/ros.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
</pre></div>
</div>
<p>Pour obtenir la définition de message <code class="docutils literal notranslate"><span class="pre">std_msgs/String</span></code>, à la place de <code class="docutils literal notranslate"><span class="pre">std_msgs/String.h</span></code>, nous devons inclure <code class="docutils literal notranslate"><span class="pre">std_msgs/msg/string.hpp</span></code> :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//#include &quot;std_msgs/String.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-c-library-calls">
<h4>Modification des appels de bibliothèque C++<a class="headerlink" href="#changing-c-library-calls" title="Lien permanent vers ce titre"></a></h4>
<p>Au lieu de passer le nom du nœud à l’appel d’initialisation de la bibliothèque, nous effectuons l’initialisation, puis passons le nom du nœud à la création de l’objet nœud (nous pouvons utiliser le mot-clé <code class="docutils literal notranslate"><span class="pre">auto</span></code> car nous avons maintenant besoin d’un C++ 14 compilateur):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  ros::init(argc, argv, &quot;talker&quot;);</span>
<span class="c1">//  ros::NodeHandle n;</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;talker&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>La création des objets d’éditeur et de taux semble assez similaire, avec quelques changements dans les noms de l’espace de noms et des méthodes.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  ros::Publisher chatter_pub = n.advertise&lt;std_msgs::String&gt;(&quot;chatter&quot;, 1000);</span>
<span class="c1">//  ros::Rate loop_rate(10);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="mi">1000</span><span class="p">);</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="nf">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>Pour mieux contrôler la manière dont la livraison des messages est gérée, un profil de qualité de service (<code class="docutils literal notranslate"><span class="pre">QoS</span></code>) peut être transmis. Le profil par défaut est <code class="docutils literal notranslate"><span class="pre">rmw_qos_profile_default</span></code>. Pour plus de détails, consultez le <a class="reference external" href="https://design.ros2.org/articles/qos.html">document de conception</a> et la <code class="xref any docutils literal notranslate"><span class="pre">vue</span> <span class="pre">d'ensemble</span> <span class="pre">du</span> <span class="pre">concept</span></code>.</p>
<p>La création du message sortant est différente dans l’espace de noms :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  std_msgs::String msg;</span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Au lieu de <code class="docutils literal notranslate"><span class="pre">ros::ok()</span></code>, nous appelons <code class="docutils literal notranslate"><span class="pre">rclcpp::ok()</span></code> :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  while (ros::ok())</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
</pre></div>
</div>
<p>Dans la boucle de publication, nous accédons au champ <code class="docutils literal notranslate"><span class="pre">data</span></code> comme précédemment :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
</pre></div>
</div>
<p>Pour imprimer un message console, au lieu d’utiliser <code class="docutils literal notranslate"><span class="pre">ROS_INFO()</span></code>, nous utilisons <code class="docutils literal notranslate"><span class="pre">RCLCPP_INFO()</span></code> et ses différents cousins. La principale différence est que <code class="docutils literal notranslate"><span class="pre">RCLCPP_INFO()</span></code> prend un objet Logger comme premier argument.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//    ROS_INFO(&quot;%s&quot;, msg.data.c_str());</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</pre></div>
</div>
<p>La publication du message est la même qu’avant :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">chatter_pub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</pre></div>
</div>
<p>La rotation (c’est-à-dire laisser le système de communication traiter tous les messages entrants/sortants en attente) est différente en ce sens que l’appel prend désormais le nœud comme argument :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//    ros::spinOnce();</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_some</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
</pre></div>
</div>
<p>Dormir à l’aide de l’objet tarif reste inchangé.</p>
<p>En mettant tout cela ensemble, le nouveau <code class="docutils literal notranslate"><span class="pre">talker.cpp</span></code> ressemble à ceci :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
<span class="c1">// #include &quot;ros/ros.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="c1">// #include &quot;std_msgs/String.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="c1">//  ros::init(argc, argv, &quot;talker&quot;);</span>
<span class="c1">//  ros::NodeHandle n;</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;talker&quot;</span><span class="p">);</span>
<span class="c1">//  ros::Publisher chatter_pub = n.advertise&lt;std_msgs::String&gt;(&quot;chatter&quot;, 1000);</span>
<span class="c1">//  ros::Rate loop_rate(10);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="n">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="c1">//  std_msgs::String msg;</span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="c1">//  while (ros::ok())</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">    </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;hello world &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="c1">//    ROS_INFO(&quot;%s&quot;, msg.data.c_str());</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="n">chatter_pub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="c1">//    ros::spinOnce();</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_some</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="w">    </span><span class="n">loop_rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-the-package-xml">
<h4>Changer le <code class="docutils literal notranslate"><span class="pre">package.xml</span></code><a class="headerlink" href="#changing-the-package-xml" title="Lien permanent vers ce titre"></a></h4>
<p>ROS 2 ne prend pas en charge le format 1 de la spécification du package, mais uniquement les versions de format plus récentes (2 et supérieures). Nous commençons par spécifier la version du format dans la balise <code class="docutils literal notranslate"><span class="pre">package</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- &lt;package&gt; --&gt;</span>
<span class="nt">&lt;package</span><span class="w"> </span><span class="na">format=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>ROS 2 utilise une version plus récente de <code class="docutils literal notranslate"><span class="pre">catkin</span></code>, appelée <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code>, que nous spécifions dans la balise <code class="docutils literal notranslate"><span class="pre">buildtool_depend</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
</pre></div>
</div>
<p>Dans nos dépendances de construction, au lieu de <code class="docutils literal notranslate"><span class="pre">roscpp</span></code>, nous utilisons <code class="docutils literal notranslate"><span class="pre">rclcpp</span></code>, qui fournit l’API C++ que nous utilisons.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;build_depend&gt;roscpp&lt;/build_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_depend&gt;</span>rclcpp<span class="nt">&lt;/build_depend&gt;</span>
</pre></div>
</div>
<p>Nous faisons le même ajout dans les dépendances d’exécution et mettons également à jour la balise <code class="docutils literal notranslate"><span class="pre">run_depend</span></code> vers la balise <code class="docutils literal notranslate"><span class="pre">exec_depend</span></code> (partie de la mise à niveau vers la version 2 du format de package) :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;run_depend&gt;roscpp&lt;/run_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;exec_depend&gt;</span>rclcpp<span class="nt">&lt;/exec_depend&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;std_msgs&lt;/run_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;exec_depend&gt;</span>std_msgs<span class="nt">&lt;/exec_depend&gt;</span>
</pre></div>
</div>
<p>Dans ROS 1, nous utilisons <code class="docutils literal notranslate"><span class="pre">&lt;depend&gt;</span></code> pour simplifier la spécification des dépendances à la fois pour la compilation et l’exécution. Nous pouvons faire la même chose dans ROS 2 :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>std_msgs<span class="nt">&lt;/depend&gt;</span>
</pre></div>
</div>
<p>Nous devons également dire à l’outil de construction quel <em>type</em> de paquet nous sommes, afin qu’il sache comment nous construire. Parce que nous utilisons <code class="docutils literal notranslate"><span class="pre">ament</span></code> et CMake, nous ajoutons les lignes suivantes pour déclarer notre type de construction comme étant <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
<span class="w">  </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
<p>En mettant tout cela ensemble, notre <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> ressemble maintenant à ceci :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- &lt;package&gt; --&gt;</span>
<span class="nt">&lt;package</span><span class="w"> </span><span class="na">format=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;name&gt;</span>talker<span class="nt">&lt;/name&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
<span class="w">  </span><span class="nt">&lt;description&gt;</span>talker<span class="nt">&lt;/description&gt;</span>
<span class="w">  </span><span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;gerkey@osrfoundation.org&quot;</span><span class="nt">&gt;</span>Brian<span class="w"> </span>Gerkey<span class="nt">&lt;/maintainer&gt;</span>
<span class="w">  </span><span class="nt">&lt;license&gt;</span>Apache<span class="w"> </span>License<span class="w"> </span>2.0<span class="nt">&lt;/license&gt;</span>
<span class="cm">&lt;!--  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="cm">&lt;!--  &lt;build_depend&gt;roscpp&lt;/build_depend&gt; --&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;roscpp&lt;/run_depend&gt; --&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;std_msgs&lt;/run_depend&gt; --&gt;</span>
<span class="w">  </span><span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;depend&gt;</span>std_msgs<span class="nt">&lt;/depend&gt;</span>
<span class="w">  </span><span class="nt">&lt;export&gt;</span>
<span class="w">    </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="w">  </span><span class="nt">&lt;/export&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
<p><strong>TODO : affiche une version plus simple de ce fichier en utilisant simplement la balise ``&lt;depend&gt;``, qui est activée par la version 2 du format de package (également prise en charge dans ``catkin`` donc, à proprement parler, orthogonale à ROS 2 ).</strong></p>
</div>
<div class="section" id="changing-the-cmake-code">
<h4>Changer le code CMake<a class="headerlink" href="#changing-the-cmake-code" title="Lien permanent vers ce titre"></a></h4>
<p>ROS 2 s’appuie sur une version supérieure de CMake :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#cmake_minimum_required(VERSION 2.8.3)</span>
cmake_minimum_required<span class="o">(</span>VERSION<span class="w"> </span><span class="m">3</span>.5<span class="o">)</span>
</pre></div>
</div>
<p>ROS 2 s’appuie sur la norme C++14. Selon le compilateur que vous utilisez, la prise en charge de C++14 peut ne pas être activée par défaut. En utilisant <code class="docutils literal notranslate"><span class="pre">gcc</span></code> 5.3 (ce qui est utilisé sur Ubuntu Xenial), nous devons l’activer explicitement, ce que nous faisons en ajoutant cette ligne en haut du fichier :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
</pre></div>
</div>
<p>La façon préférée de travailler sur toutes les plateformes est la suivante :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
<p>En utilisant <code class="docutils literal notranslate"><span class="pre">catkin</span></code>, nous spécifions les packages avec lesquels nous voulons construire en les passant comme arguments <code class="docutils literal notranslate"><span class="pre">COMPONENTS</span></code> lors de la recherche initiale de <code class="docutils literal notranslate"><span class="pre">catkin</span></code> lui-même. Avec <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code>, nous trouvons chaque paquet individuellement, en commençant par <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#find_package(catkin REQUIRED COMPONENTS roscpp std_msgs)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">std_msgs</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</pre></div>
</div>
<p>Les dépendances du système peuvent être trouvées comme avant :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">Boost</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">system</span><span class="w"> </span><span class="s">filesystem</span><span class="w"> </span><span class="s">thread</span><span class="p">)</span>
</pre></div>
</div>
<p>Nous appelons <code class="docutils literal notranslate"><span class="pre">catkin_package()</span></code> pour générer automatiquement des choses comme les fichiers de configuration CMake pour d’autres packages qui utilisent notre package. Alors que cet appel se produit <em>avant</em> de spécifier les cibles à construire, nous appelons maintenant l’analogue <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> <em>après</em> les cibles :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># catkin_package()</span>
<span class="c"># At the bottom of the file:</span>
<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p>Les seuls répertoires qui doivent être inclus manuellement sont les répertoires locaux et les dépendances qui ne sont pas des packages d’ament :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#include_directories(${catkin_INCLUDE_DIRS})</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="s">include</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>Une meilleure alternative consiste à spécifier les répertoires d’inclusion pour chaque cible individuellement, plutôt que d’inclure tous les répertoires pour toutes les cibles :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">target</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">include</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>De la même manière que nous avons trouvé chaque package dépendant séparément, nous devons lier chacun à la cible de construction. Pour créer un lien avec des packages dépendants qui sont des packages ament, au lieu d’utiliser <code class="docutils literal notranslate"><span class="pre">target_link_libraries()</span></code>, <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies()</span></code> est une manière plus concise et plus approfondie de gérer les drapeaux de construction. Il gère automatiquement à la fois les répertoires d’inclusion définis dans <code class="docutils literal notranslate"><span class="pre">_INCLUDE_DIRS</span></code> et les bibliothèques de liens définies dans <code class="docutils literal notranslate"><span class="pre">_LIBRARIES</span></code>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#target_link_libraries(talker ${catkin_LIBRARIES})</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">talker</span>
<span class="w">  </span><span class="s">rclcpp</span>
<span class="w">  </span><span class="s">std_msgs</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour créer un lien avec des packages qui ne sont pas des packages ament, tels que des dépendances système comme <code class="docutils literal notranslate"><span class="pre">Boost</span></code>, ou une bibliothèque construite dans le même <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>, utilisez <code class="docutils literal notranslate"><span class="pre">target_link_libraries()</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">target</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour l’installation, <code class="docutils literal notranslate"><span class="pre">catkin</span></code> définit des variables comme <code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_BIN_DESTINATION</span></code>. Avec <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code>, on donne juste un chemin relatif à la racine d’installation, comme <code class="docutils literal notranslate"><span class="pre">bin</span></code> pour les exécutables :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#install(TARGETS talker</span>
<span class="c">#  RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION})</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>En option, nous pouvons installer et exporter les répertoires inclus pour les packages en aval :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span><span class="s">DIRECTORY</span><span class="w"> </span><span class="s">include/</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
</pre></div>
</div>
<p>En option, nous pouvons exporter les dépendances pour les packages en aval :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_export_dependencies</span><span class="p">(</span><span class="s">std_msgs</span><span class="p">)</span>
</pre></div>
</div>
<p>En mettant tout cela ensemble, le nouveau <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> ressemble à ceci :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#cmake_minimum_required(VERSION 2.8.3)</span>
<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.5</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">talker</span><span class="p">)</span>
<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="c">#find_package(catkin REQUIRED COMPONENTS roscpp std_msgs)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">std_msgs</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c">#catkin_package()</span>
<span class="c">#include_directories(${catkin_INCLUDE_DIRS})</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="s">talker.cpp</span><span class="p">)</span>
<span class="c">#target_link_libraries(talker ${catkin_LIBRARIES})</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">talker</span>
<span class="w">  </span><span class="s">rclcpp</span>
<span class="w">  </span><span class="s">std_msgs</span><span class="p">)</span>
<span class="c">#install(TARGETS talker</span>
<span class="c">#  RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION})</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
<span class="nb">install</span><span class="p">(</span><span class="s">DIRECTORY</span><span class="w"> </span><span class="s">include/</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_dependencies</span><span class="p">(</span><span class="s">std_msgs</span><span class="p">)</span>
<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>TODO : Montrez à quoi cela ressemblerait avec ``ament_auto``.</strong></p>
</div>
<div class="section" id="building-the-ros-2-code">
<h4>Construire le code ROS 2<a class="headerlink" href="#building-the-ros-2-code" title="Lien permanent vers ce titre"></a></h4>
<p>Nous créons un fichier de configuration d’environnement (dans ce cas, celui généré en suivant le tutoriel d’installation de ROS 2, qui se construit dans <code class="docutils literal notranslate"><span class="pre">~/ros2_ws</span></code>, puis nous construisons notre paquet en utilisant <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>~/ros2_ws/install/setup.bash
<span class="nb">cd</span><span class="w"> </span>~/ros2_talker
colcon<span class="w"> </span>build
</pre></div>
</div>
</div>
<div class="section" id="running-the-ros-2-node">
<h4>Exécution du nœud ROS 2<a class="headerlink" href="#running-the-ros-2-node" title="Lien permanent vers ce titre"></a></h4>
<p>Parce que nous avons installé l’exécutable <code class="docutils literal notranslate"><span class="pre">talker</span></code> dans <code class="docutils literal notranslate"><span class="pre">bin</span></code>, après avoir récupéré le fichier d’installation, à partir de notre arbre d’installation, nous pouvons l’invoquer directement par son nom (de plus, il n’y a pas encore d’équivalent ROS 2 pour <a href="#id1"><span class="problematic" id="id2">``</span></a>rosrun <a href="#id3"><span class="problematic" id="id4">``</span></a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="w"> </span>~/ros2_ws/install/setup.bash
talker
</pre></div>
</div>
</div>
</div>
<div class="section" id="update-scripts">
<h3><a class="toc-backref" href="#id13">Mettre à jour les scripts</a><a class="headerlink" href="#update-scripts" title="Lien permanent vers ce titre"></a></h3>
<div class="section" id="ros-cli-arguments">
<h4>Arguments de la CLI ROS<a class="headerlink" href="#ros-cli-arguments" title="Lien permanent vers ce titre"></a></h4>
<p>Depuis <a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html"><span class="doc">ROS Eloquent</span></a>, les arguments ROS doivent être définis avec <code class="docutils literal notranslate"><span class="pre">--ros-args</span></code> et un <code class="docutils literal notranslate"><span class="pre">--</span></code> final (le double tiret final peut être élidé si aucun argument ne le suit).</p>
<p>Le remappage des noms est similaire à ROS 1, prenant la forme <code class="docutils literal notranslate"><span class="pre">from:=to</span></code>, sauf qu’il doit être précédé d’un drapeau <code class="docutils literal notranslate"><span class="pre">--remap</span></code> (ou <code class="docutils literal notranslate"><span class="pre">-r</span></code>). Par exemple:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>some_package<span class="w"> </span>some_ros_executable<span class="w"> </span>--ros-args<span class="w"> </span>-r<span class="w"> </span>foo:<span class="o">=</span>bar
</pre></div>
</div>
<p>Nous utilisons une syntaxe similaire pour les paramètres, en utilisant le drapeau <code class="docutils literal notranslate"><span class="pre">--param</span></code> (ou <code class="docutils literal notranslate"><span class="pre">-p</span></code>) :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>some_package<span class="w"> </span>some_ros_executable<span class="w"> </span>--ros-args<span class="w"> </span>-p<span class="w"> </span>my_param:<span class="o">=</span>value
</pre></div>
</div>
<p>Notez que ceci est différent de l’utilisation d’un trait de soulignement initial dans ROS 1.</p>
<p>Pour changer un nom de nœud, utilisez <code class="docutils literal notranslate"><span class="pre">__node</span></code> (l’équivalent ROS 1 est <code class="docutils literal notranslate"><span class="pre">__name</span></code>) :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>some_package<span class="w"> </span>some_ros_executable<span class="w"> </span>--ros-args<span class="w"> </span>-r<span class="w"> </span>__node:<span class="o">=</span>new_node_name
</pre></div>
</div>
<p>Notez l’utilisation du drapeau <code class="docutils literal notranslate"><span class="pre">-r</span></code>. Le même drapeau de remappage est nécessaire pour changer l’espace de noms <code class="docutils literal notranslate"><span class="pre">__ns</span></code> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>some_package<span class="w"> </span>some_ros_executable<span class="w"> </span>--ros-args<span class="w"> </span>-r<span class="w"> </span>__ns:<span class="o">=</span>/new/namespace
</pre></div>
</div>
<p>Il n’y a pas d’équivalent dans ROS 2 pour les clés ROS 1 suivantes :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__log</span></code> (mais <code class="docutils literal notranslate"><span class="pre">--log-config-file</span></code> peut être utilisé pour fournir un fichier de configuration de l’enregistreur)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__ip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__hostname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__maître</span></code></p></li>
</ul>
<p>Pour plus d’informations, consultez le <a class="reference external" href="https://design.ros2.org/articles/ros_command_line_arguments.html">document de conception</a>.</p>
<div class="section" id="quick-reference">
<h5>Référence rapide<a class="headerlink" href="#quick-reference" title="Lien permanent vers ce titre"></a></h5>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 32%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Fonctionnalité</p></th>
<th class="head"><p>RSO 1</p></th>
<th class="head"><p>RSO 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>remappage</p></td>
<td><p>toto:=bar</p></td>
<td><p>-r toto:=bar</p></td>
</tr>
<tr class="row-odd"><td><p>paramètres</p></td>
<td><p>_foo :=barre</p></td>
<td><p>-p toto:=bar</p></td>
</tr>
<tr class="row-even"><td><p>nom du nœud</p></td>
<td><p>__name:=foo</p></td>
<td><p>-r __node:=foo</p></td>
</tr>
<tr class="row-odd"><td><p>espace de noms</p></td>
<td><p>__ns:=foo</p></td>
<td><p>-r __ns:=foo</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="more-examples-and-tools">
<h3><a class="toc-backref" href="#id14">Plus d’exemples et d’outils</a><a class="headerlink" href="#more-examples-and-tools" title="Lien permanent vers ce titre"></a></h3>
<ul class="simple">
<li><p>Migrateur de fichiers de lancement qui convertit un fichier de lancement XML ROS 1 en un fichier de lancement Python ROS 2 : <a class="reference external" href="https://github.com/aws-robotics/ros2-launch-file-migrator">https://github.com/aws-robotics/ros2-launch-file-migrator</a></p></li>
<li><p>Amazon a exposé ses outils de portage des robots ROS 1 vers ROS 2 <a class="reference external" href="https://github.com/awslabs/ros2-migration-tools/tree/master/porting_tools">https://github.com/awslabs/ros2-migration-tools/tree/master/porting_tools</a></p></li>
</ul>
</div>
</div>
<div class="section" id="licensing">
<h2><a class="toc-backref" href="#id15">Licence</a><a class="headerlink" href="#licensing" title="Lien permanent vers ce titre"></a></h2>
<p>Dans ROS 2, notre licence recommandée est la <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Licence Apache 2.0</a>. Dans ROS 1, notre licence recommandée était la <a class="reference external" href="https://opensource.org/licenses/BSD-3-Clause">3-Clause BSD License</a>.</p>
<p>Pour tout nouveau projet, nous vous recommandons d’utiliser la licence Apache 2.0, que ce soit ROS 1 ou ROS 2.</p>
<p>Cependant, lors de la migration du code de ROS 1 vers ROS 2, nous ne pouvons pas simplement changer la licence. La licence existante doit être conservée pour toute contribution préexistante.</p>
<p>À cette fin, si un package est en cours de migration, nous vous recommandons de conserver la licence existante et de continuer à contribuer à ce package sous la licence OSI existante, qui devrait être la licence BSD pour les éléments principaux.</p>
<p>Cela gardera les choses claires et faciles à comprendre.</p>
<div class="section" id="changing-the-license">
<h3><a class="toc-backref" href="#id16">Modification de la licence</a><a class="headerlink" href="#changing-the-license" title="Lien permanent vers ce titre"></a></h3>
<p>Il est possible de modifier la licence, mais vous devrez contacter tous les contributeurs et obtenir leur autorisation. Pour la plupart des packages, cela représente probablement un effort important et ne vaut pas la peine d’être pris en compte. Si le paquet a un petit ensemble de contributeurs, cela peut être faisable.</p>
</div>
</div>
</div>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="Quality-Guide.html" class="btn btn-neutral float-left" title="Guide qualité : assurer la qualité du code" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="Migration-Guide-Python.html" class="btn btn-neutral float-right" title="Guide de migration Python depuis ROS 1" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Open Robotics.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>