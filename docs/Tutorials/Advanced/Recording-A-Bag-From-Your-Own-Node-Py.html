<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Enregistrer un sac à partir d’un nœud (Python) &mdash; Documentation ROS 2 documentation </title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.ros.org/en/Tutorials/Advanced/Recording-A-Bag-From-Your-Own-Node-Py.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Simulation" href="Simulators/Simulation-Main.html" />
    <link rel="prev" title="Enregistrer un sac à partir d’un nœud (C++)" href="Recording-A-Bag-From-Your-Own-Node-CPP.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> ROS 2 documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Install-Debians.html">Ubuntu (Debian)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Windows-Install-Binary.html">Windows (binaire)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/RHEL-Install-RPMs.html">RHEL (RPM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Alternatives.html">Alternatives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Development-Setup.html">gratuit (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Install-Binary.html">gratuit (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Windows-Development-Setup.html">Windows (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Development-Setup.html">RHEL (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Install-Binary.html">RHEL (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/macOS-Development-Setup.html">mac OS (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Fedora-Development-Setup.html">Fedora (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Latest-Development-Setup.html">Dernier développement (source)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Maintaining-a-Source-Checkout.html">Maintenir la vérification de la source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Testing.html">Tester avec des binaires de pré-version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/DDS-Implementations.html">Implémentations DDS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-Security-Plugins.html">Plugins de sécurité Connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-University-Eval.html">RTI Connect DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">Éclipse Cyclone DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-GurumNetworks-GurumDDS.html">GurumNetworks GurumDDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-eProsima-Fast-DDS.html">DDS rapide eProsima</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Releases.html">Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Humble-Hawksbill.html">Humble Hawksbill (<code class="docutils literal notranslate"><span class="pre">humble</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Humble-Hawksbill-Complete-Changelog.html">Journal des modifications de Humble Hawksbill</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Foxy-Fitzroy.html">Foxy Fitzroy (<code class="docutils literal notranslate"><span class="pre">foxy</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Rolling-Ridley.html">Rouler Ridley (<code class="docutils literal notranslate"><span class="pre">rouler</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Development.html">Développement Répartition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Iron-Irwini.html">ROS 2 Iron Irwini (nom de code “iron”; mai 2023)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/End-of-Life.html">Distributions en fin de vie</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Galactic-Geochelone.html">Géochelone Galactique (<code class="docutils literal notranslate"><span class="pre">galactique</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Releases/Galactic-Geochelone-Complete-Changelog.html">Journal des modifications de Galactic Geochelone</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html">Eloquent Elusor (``éloquent””)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Dashing-Diademata.html">Dashing Diademata (<code class="docutils literal notranslate"><span class="pre">fringant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Crystal-Clemmys.html">Cristal Clemmys (<code class="docutils literal notranslate"><span class="pre">cristal</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Bouncy-Bolson.html">Bouncy Bolson (<code class="docutils literal notranslate"><span class="pre">rebondissant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Ardent-Apalone.html">Apalone ardent (<code class="docutils literal notranslate"><span class="pre">ardent</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta3-Overview.html">Bêta 3 (<code class="docutils literal notranslate"><span class="pre">r2b3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta2-Overview.html">Bêta 2 (<code class="docutils literal notranslate"><span class="pre">r2b2</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta1-Overview.html">Bêta 1 (<code class="docutils literal notranslate"><span class="pre">Asphalte</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Alpha-Overview.html">Alphas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Process.html">Processus de développement d’une version</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Tutorials.html">Tutoriels</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Beginner-CLI-Tools.html">Débutant : outils CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Configuring-ROS2-Environment.html">Configuration de l’environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html">Utiliser <code class="docutils literal notranslate"><span class="pre">turtlesim</span></code> et <code class="docutils literal notranslate"><span class="pre">rqt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Nodes/Understanding-ROS2-Nodes.html">Comprendre les nœuds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Topics/Understanding-ROS2-Topics.html">Comprendre les sujets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html">Comprendre les services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html">Comprendre les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html">Comprendre les actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Using-Rqt-Console/Using-Rqt-Console.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">rqt_console</span></code> pour afficher les journaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Launching-Multiple-Nodes/Launching-Multiple-Nodes.html">Nœuds de lancement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html">Enregistrement et lecture de données</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Beginner-Client-Libraries.html">Débutant : Bibliothèques clientes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Colcon-Tutorial.html">Utiliser <code class="docutils literal notranslate"><span class="pre">colcon</span></code> pour créer des packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html">Créer un espace de travail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html">Création d’un paquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Service-And-Client.html">Ecrire un service et un client simples (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Py-Service-And-Client.html">Écrire un service et un client simples (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Custom-ROS2-Interfaces.html">Création de fichiers msg et srv personnalisés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Single-Package-Define-And-Use-Interface.html">Implémentation d’interfaces personnalisées</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Using-Parameters-In-A-Class-CPP.html">Utiliser des paramètres dans une classe (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Using-Parameters-In-A-Class-Python.html">Utiliser des paramètres dans une classe (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Getting-Started-With-Ros2doctor.html">Utiliser <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> pour identifier les problèmes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Pluginlib.html">Créer et utiliser des plugins (C++)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Intermediate.html">Intermédiaire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Rosdep.html">Gestion des dépendances avec rosdep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Creating-an-Action.html">Créer une action</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Writing-an-Action-Server-Client/Cpp.html">Ecriture d’un serveur d’action et d’un client (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Writing-an-Action-Server-Client/Py.html">Ecriture d’un serveur d’action et d’un client (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Composition.html">Composer plusieurs nœuds en un seul processus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Monitoring-For-Parameter-Changes-CPP.html">Surveillance des changements de paramètres (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Launch/Launch-Main.html">Lancement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Creating-Launch-Files.html">Création d’un fichier de lancement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Launch-system.html">Intégration des fichiers de lancement dans les packages ROS 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-Substitutions.html">Utiliser des substitutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-Event-Handlers.html">Utilisation des gestionnaires d’événements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-ROS2-Launch-For-Large-Projects.html">Gestion de grands projets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Tf2/Tf2-Main.html">tracé</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Introduction-To-Tf2.html">Présentation de <code class="docutils literal notranslate"><span class="pre">tf2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Py.html">Écrire un diffuseur statique (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Cpp.html">Écrire un diffuseur statique (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Py.html">Écrire un diffuseur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Cpp.html">Ecrire un diffuseur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Listener-Py.html">Écrire un écouteur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Listener-Cpp.html">Écrire un écouteur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Adding-A-Frame-Py.html">Ajouter un cadre (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Adding-A-Frame-Cpp.html">Ajouter un cadre (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Learning-About-Tf2-And-Time-Py.html">Utiliser le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Learning-About-Tf2-And-Time-Cpp.html">Utilisation du temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Time-Travel-With-Tf2-Py.html">Voyager dans le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Time-Travel-With-Tf2-Cpp.html">Voyager dans le temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Debugging-Tf2-Problems.html">Débogage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Quaternion-Fundamentals.html">Fondamentaux du quaternion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Using-Stamped-Datatypes-With-Tf2-Ros-MessageFilter.html">Utiliser des types de données tamponnés avec <code class="docutils literal notranslate"><span class="pre">tf2_ros::MessageFilter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Testing/Testing-Main.html">Essai</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Testing/CLI.html">Exécution de tests dans ROS 2 à partir de la ligne de commande</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Testing/Python.html">Écrire des tests de base avec Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/URDF/URDF-Main.html">URDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Building-a-Visual-Robot-Model-with-URDF-from-Scratch.html">Construire un modèle de robot visuel à partir de zéro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Building-a-Movable-Robot-Model-with-URDF.html">Construire un modèle de robot mobile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model.html">Ajout de propriétés physiques et de collision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Using-Xacro-to-Clean-Up-a-URDF-File.html">Utiliser Xacro pour nettoyer votre code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Using-URDF-with-Robot-State-Publisher.html">Utiliser URDF avec <code class="docutils literal notranslate"><span class="pre">robot_state_publisher</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../Advanced.html">Avancé</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Topic-Statistics-Tutorial/Topic-Statistics-Tutorial.html">Activation des statistiques de sujet (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Discovery-Server/Discovery-Server.html">Utilisation de Fast DDS Discovery Server comme protocole de découverte [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="Allocator-Template-Tutorial.html">Implémentation d’un répartiteur de mémoire personnalisé</a></li>
<li class="toctree-l3"><a class="reference internal" href="FastDDS-Configuration.html">Libérer le potentiel du middleware Fast DDS [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="Recording-A-Bag-From-Your-Own-Node-CPP.html">Enregistrer un sac à partir d’un nœud (C++)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Enregistrer un sac à partir d’un nœud (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Simulators/Simulation-Main.html">Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Simulators/Webots.html">Mise en place d’une simulation de robot (Webots)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Simulators/Gazebo.html">Mise en place d’une simulation de robot (Gazebo)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Security/Security-Main.html">Sécurité</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Security/Introducing-ros2-security.html">Mise en place de la sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/The-Keystore.html">Comprendre le magasin de clés de sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Security-on-Two.html">Garantir la sécurité sur toutes les machines</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Examine-Traffic.html">Examen du trafic réseau</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Access-Controls.html">Paramétrage des contrôles d’accès</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Demos.html">Démos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Quality-of-Service.html">Utilisation des paramètres de qualité de service pour les réseaux avec perte</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Managed-Nodes.html">Gestion des nœuds avec des cycles de vie gérés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Intra-Process-Communication.html">Mettre en place une communication intra-process efficace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Rosbag-with-ROS1-Bridge.html">Enregistrement et lecture de données avec <code class="docutils literal notranslate"><span class="pre">rosbag</span></code> en utilisant le pont ROS 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Real-Time-Programming.html">Comprendre la programmation temps réel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/dummy-robot-demo.html">Expérimenter avec un robot factice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Logging-and-logger-configuration.html">Enregistrement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Content-Filtering-Subscription.html">Création d’un abonnement au filtrage de contenu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Miscellaneous.html">Divers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Deploying-ROS-2-on-IBM-Cloud.html">Déploiement sur IBM Cloud Kubernetes [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Eclipse-Oxygen-with-ROS-2-and-rviz2.html">Utiliser Eclipse Oxygen avec <code class="docutils literal notranslate"><span class="pre">rviz2</span></code> [community-contributed]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Building-Realtime-rt_preempt-kernel-for-ROS-2.html">Construire un noyau Linux en temps réel [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Building-ROS2-Package-with-eclipse-2021-06.html">Construire un package avec Eclipse 2021-06</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../How-To-Guides.html">Guides pratiques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installation-Troubleshooting.html">Dépannage de l’installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Developing-a-ROS-2-Package.html">Développement d’un package ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Documentation.html">documentation utilisateur ament_cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Python-Documentation.html">documentation utilisateur ament_cmake_python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-files-migration-guide.html">Migration des fichiers de lancement de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-file-different-formats.html">Utilisation de Python, XML et YAML pour les fichiers de lancement ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launching-composable-nodes.html">Utilisation du lancement de ROS 2 pour lancer des nœuds composables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html">Migration des fichiers de paramètres YAML de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Node-arguments.html">Passer des arguments ROS aux nœuds via la ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Sync-Vs-Async.html">Clients de service synchrones ou asynchrones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/DDS-tuning.html">Informations de réglage DDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Overriding-QoS-Policies-For-Recording-And-Playback.html">rosbag2 : Remplacement des politiques de QoS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Working-with-multiple-RMW-implementations.html">Travailler avec plusieurs implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Cross-compilation.html">Compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Releasing/Releasing-a-Package.html">Libérer un paquet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/First-Time-Release.html">Première sortie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Subsequent-Releases.html">Versions ultérieures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Team-Repository.html">Équipe de publication / Référentiel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Track.html">Piste de sortie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Python-Packages.html">Utilisation de packages Python avec ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Port-Plugin-Windows.html">Portage des plugins RQt vers Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Run-2-nodes-in-single-or-separate-docker-containers.html">Exécution de nœuds ROS 2 dans Docker [contribution de la communauté]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Visualizing-ROS-2-Data-With-Foxglove-Studio.html">Visualiser les données ROS 2 avec Foxglove Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Package-maintainer-guide.html">Guide du responsable du paquet ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-a-Custom-Debian-Package.html">Construire un paquet Debian personnalisé</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-ROS-2-with-Tracing-Instrumentation.html">Construire ROS 2 avec instrumentation de traçage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Topics-Services-Actions.html">Sujets vs Services vs Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Variants.html">Utiliser des variantes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros2-param.html">Utilisation de l’outil de ligne de commande <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros1_bridge-Jammy-upstream.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">ros1_bridge</span></code> avec ROS en amont sur Ubuntu 22.04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Disabling-ZeroCopy-loaned-messages.html">Désactivation des messages prêtés sans copie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installing-on-Raspberry-Pi.html">ROS 2 sur Raspberry Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-callback-groups.html">Utilisation des groupes de rappel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install.html">Construire RQt à partir de la source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-MacOS.html">Construire RQt à partir de la source sur macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-Windows10.html">Construire RQt à partir de la source sur Windows 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Concepts.html">Notions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Domain-ID.html">Le ROS_DOMAIN_ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Different-Middleware-Vendors.html">À propos des différents fournisseurs ROS 2 DDS/RTPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Logging.html">À propos de la journalisation et de la configuration de l’enregistreur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html">À propos des paramètres de qualité de service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-Interfaces.html">À propos des interfaces ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Parameters.html">À propos des paramètres dans ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Executors.html">Exécuteurs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Topic-Statistics.html">À propos des statistiques de sujet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Command-Line-Tools.html">Introspection avec des outils en ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-RQt.html">Présentation et utilisation de RQt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Composition.html">À propos de la composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Catment.html">Sur le mélange d’ament et de chaton (catment)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Cross-Compilation.html">À propos de la compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Security.html">À propos de la sécurité ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Tf2.html">À propos de TF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Build-System.html">À propos du système de construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Internal-Interfaces.html">À propos des interfaces ROS 2 internes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Middleware-Implementations.html">À propos des implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contacter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../The-ROS2-Project.html">Le projet ROS 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Contributing.html">Contribuant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Developer-Guide.html">Guide du développeur ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Code-Style-Language-Versions.html">Style de code et versions linguistiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Quality-Guide.html">Guide qualité : assurer la qualité du code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Migration-Guide.html">Guide de migration depuis ROS 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Migration-Guide-Python.html">Guide de migration Python depuis ROS 1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Build-Farms.html">Fermes de construction ROS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Windows-Tips-and-Tricks.html">Trucs et astuces Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Contributing-To-ROS-2-Documentation.html">Contribuer à la documentation ROS 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Features.html">Statut des fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Feature-Ideas.html">Idées de fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Roadmap.html">Feuille de route</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/ROSCon-Content.html">Pourparlers ROSCon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Governance.html">Gouvernance du projet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/ROS2-TSC-Charter.html">Charte du comité de pilotage technique ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/ROS2-TSC-Intake-process.html">Processus d’admission des candidats ROS 2 TSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/How-To-Start-A-Community-Working-Group.html">Comment démarrer un groupe de travail communautaire</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Marketing.html">Commercialisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Related-Projects.html">Projets liés</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Intel-ROS2-Projects.html">Projets Intel ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Nvidia-ROS2-Projects.html">Projets NVIDIA ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Citations.html">Citations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ROS 2 documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../Tutorials.html">Tutoriels</a></li>
          <li class="breadcrumb-item"><a href="../Advanced.html">Avancé</a></li>
      <li class="breadcrumb-item active">Enregistrer un sac à partir d’un nœud (Python)</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros2/ros2_documentation/blob/rolling/source/Tutorials/Advanced/Recording-A-Bag-From-Your-Own-Node-Py.rst" class="fa fa-github"> Éditer sur GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <div class="section" id="recording-a-bag-from-a-node-python">
<span id="ros2bagownnodepython"></span><h1>Enregistrer un sac à partir d’un nœud (Python)<a class="headerlink" href="#recording-a-bag-from-a-node-python" title="Lien permanent vers ce titre"></a></h1>
<p><strong>Objectif :</strong> Enregistrez les données de votre propre nœud Python dans un sac.</p>
<p><strong>Niveau du didacticiel :</strong> Avancé</p>
<p><strong>Durée :</strong> 20 minutes</p>
<div class="contents local topic" id="contents">
<p class="topic-title">Contenu</p>
<ul class="simple">
<li><p><a class="reference internal" href="#background" id="id6">Arrière-plan</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id7">Conditions préalables</a></p></li>
<li><p><a class="reference internal" href="#tasks" id="id8">Tâches</a></p>
<ul>
<li><p><a class="reference internal" href="#create-a-package" id="id9">1 Créer un package</a></p></li>
<li><p><a class="reference internal" href="#write-the-python-node" id="id10">2 Écrivez le nœud Python</a></p></li>
<li><p><a class="reference internal" href="#build-and-run" id="id11">3 Construire et exécuter</a></p></li>
<li><p><a class="reference internal" href="#record-synthetic-data-from-a-node" id="id12">4 Enregistrer les données synthétiques d’un nœud</a></p></li>
<li><p><a class="reference internal" href="#record-synthetic-data-from-an-executable" id="id13">5 Enregistrer des données synthétiques à partir d’un exécutable</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id14">Résumé</a></p></li>
</ul>
</div>
<div class="section" id="background">
<h2><a class="toc-backref" href="#id6">Arrière-plan</a><a class="headerlink" href="#background" title="Lien permanent vers ce titre"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">rosbag2</span></code> ne fournit pas seulement l’outil de ligne de commande <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">bag</span></code>. Il fournit également une API Python pour lire et écrire dans un sac à partir de votre propre code source. Cela vous permet de vous abonner à un sujet et d’enregistrer les données reçues dans un sac en même temps que d’effectuer tout autre traitement de votre choix sur ces données. Vous pouvez le faire, par exemple, pour enregistrer les données d’un sujet et le résultat du traitement de ces données sans avoir besoin d’envoyer les données traitées sur un sujet juste pour les enregistrer. Étant donné que toutes les données peuvent être enregistrées dans un sac, il est également possible d’enregistrer des données générées par une autre source qu’un sujet, telles que des données synthétiques pour des ensembles d’apprentissage. Ceci est utile, par exemple, pour générer rapidement un sac contenant un grand nombre d’échantillons répartis sur une longue durée de lecture.</p>
</div>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#id7">Conditions préalables</a><a class="headerlink" href="#prerequisites" title="Lien permanent vers ce titre"></a></h2>
<p>Vous devriez avoir les packages <code class="docutils literal notranslate"><span class="pre">rosbag2</span></code> installés dans le cadre de votre configuration habituelle de ROS 2.</p>
<p>Si vous avez installé des packages Debian sur Linux, il peut être installé par défaut. Si ce n’est pas le cas, vous pouvez l’installer à l’aide de cette commande.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt install ros-rolling-rosbag2</span>
</pre></div>
</div>
<p>Ce tutoriel traite de l’utilisation des sacs ROS 2, y compris depuis le terminal. Vous devriez déjà avoir terminé le <a class="reference internal" href="../Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html"><span class="doc">tutoriel de base sur le sac ROS 2</span></a>.</p>
</div>
<div class="section" id="tasks">
<h2><a class="toc-backref" href="#id8">Tâches</a><a class="headerlink" href="#tasks" title="Lien permanent vers ce titre"></a></h2>
<div class="section" id="create-a-package">
<h3><a class="toc-backref" href="#id9">1 Créer un package</a><a class="headerlink" href="#create-a-package" title="Lien permanent vers ce titre"></a></h3>
<p>Ouvrez un nouveau terminal et <a class="reference internal" href="../Beginner-CLI-Tools/Configuring-ROS2-Environment.html"><span class="doc">sourcez votre installation ROS 2</span></a> pour que les commandes <code class="docutils literal notranslate"><span class="pre">ros2</span></code> fonctionnent.</p>
<p>Suivez <span class="xref std std-ref">ces instructions</span> pour créer un nouvel espace de travail nommé <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code>.</p>
<p>Naviguez dans le répertoire <code class="docutils literal notranslate"><span class="pre">ros2_ws/src</span></code> et créez un nouveau package :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 pkg create --build-type ament_python bag_recorder_nodes_py --dependencies rclpy rosbag2_py example_interfaces std_msgs</span>
</pre></div>
</div>
<p>Votre terminal renverra un message vérifiant la création de votre package <code class="docutils literal notranslate"><span class="pre">bag_recorder_nodes_py</span></code> et tous ses fichiers et dossiers nécessaires. L’argument <code class="docutils literal notranslate"><span class="pre">--dependencies</span></code> ajoutera automatiquement les lignes de dépendance nécessaires à <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>.txt``. Dans ce cas, le package utilisera le package <code class="docutils literal notranslate"><span class="pre">rosbag2_py</span></code> ainsi que le package <code class="docutils literal notranslate"><span class="pre">rclpy</span></code>. Une dépendance sur le package <code class="docutils literal notranslate"><span class="pre">example_interfaces</span></code> est également requise pour les définitions de message.</p>
<div class="section" id="update-package-xml-and-setup-py">
<h4>1.1 Mettre à jour <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> et <code class="docutils literal notranslate"><span class="pre">setup.py</span></code><a class="headerlink" href="#update-package-xml-and-setup-py" title="Lien permanent vers ce titre"></a></h4>
<p>Comme vous avez utilisé l’option <code class="docutils literal notranslate"><span class="pre">--dependencies</span></code> lors de la création du package, vous n’avez pas besoin d’ajouter manuellement des dépendances à <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>.txt``. Comme toujours, assurez-vous d’ajouter la description, l’adresse e-mail et le nom du responsable, ainsi que les informations de licence à <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;description&gt;</span>Python<span class="w"> </span>bag<span class="w"> </span>writing<span class="w"> </span>tutorial<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;you@email.com&quot;</span><span class="nt">&gt;</span>Your<span class="w"> </span>Name<span class="nt">&lt;/maintainer&gt;</span>
<span class="nt">&lt;license&gt;</span>Apache<span class="w"> </span>License<span class="w"> </span>2.0<span class="nt">&lt;/license&gt;</span>
</pre></div>
</div>
<p>Assurez-vous également d’ajouter ces informations au fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> également.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;Your Name&#39;</span><span class="p">,</span>
<span class="n">maintainer_email</span><span class="o">=</span><span class="s1">&#39;you@email.com&#39;</span><span class="p">,</span>
<span class="n">description</span><span class="o">=</span><span class="s1">&#39;Python bag writing tutorial&#39;</span><span class="p">,</span>
<span class="n">license</span><span class="o">=</span><span class="s1">&#39;Apache License 2.0&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="write-the-python-node">
<h3><a class="toc-backref" href="#id10">2 Écrivez le nœud Python</a><a class="headerlink" href="#write-the-python-node" title="Lien permanent vers ce titre"></a></h3>
<p>Dans le répertoire <code class="docutils literal notranslate"><span class="pre">ros2_ws/src/bag_recorder_nodes_py/bag_recorder_nodes_py</span></code>, créez un nouveau fichier appelé <code class="docutils literal notranslate"><span class="pre">simple_bag_recorder.py</span></code> et collez-y le code suivant.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">rclpy.serialization</span> <span class="kn">import</span> <span class="n">serialize_message</span>
<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">import</span> <span class="nn">rosbag2_py</span>

<span class="k">class</span> <span class="nc">SimpleBagRecorder</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;simple_bag_recorder&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">SequentialWriter</span><span class="p">()</span>

        <span class="n">storage_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">StorageOptions</span><span class="p">(</span>
            <span class="n">uri</span><span class="o">=</span><span class="s1">&#39;my_bag&#39;</span><span class="p">,</span>
            <span class="n">storage_id</span><span class="o">=</span><span class="s1">&#39;sqlite3&#39;</span><span class="p">)</span>
        <span class="n">converter_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">ConverterOptions</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">converter_options</span><span class="p">)</span>

        <span class="n">topic_info</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">TopicMetadata</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;std_msgs/msg/String&#39;</span><span class="p">,</span>
            <span class="n">serialization_format</span><span class="o">=</span><span class="s1">&#39;cdr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">topic_info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_subscription</span><span class="p">(</span>
            <span class="n">String</span><span class="p">,</span>
            <span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">topic_callback</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscription</span>

    <span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
            <span class="n">serialize_message</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
    <span class="n">sbr</span> <span class="o">=</span> <span class="n">SimpleBagRecorder</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">sbr</span><span class="p">)</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="examine-the-code">
<h4>2.1 Examiner le code<a class="headerlink" href="#examine-the-code" title="Lien permanent vers ce titre"></a></h4>
<p>Les instructions <code class="docutils literal notranslate"><span class="pre">import</span></code> en haut sont les dépendances du paquet. Notez l’importation du package <code class="docutils literal notranslate"><span class="pre">rosbag2_py</span></code> pour les fonctions et les structures nécessaires pour travailler avec les fichiers bag.</p>
<p>Dans le constructeur de classe, nous commençons par créer l’objet écrivain que nous utiliserons pour écrire dans le sac. Nous créons un <code class="docutils literal notranslate"><span class="pre">SequentialWriter</span></code>, qui écrit les messages dans le sac dans l’ordre reçu. D’autres rédacteurs avec des comportements différents peuvent être disponibles dans le <a class="reference external" href="https://github.com/ros2/rosbag2/tree/rolling/rosbag2_cpp/include/rosbag2_cpp/writers">rosbag2</a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">SequentialWriter</span><span class="p">()</span>
</pre></div>
</div>
<p>Maintenant que nous avons un objet écrivain, nous pouvons ouvrir le sac en l’utilisant. Nous spécifions l’URI du sac à créer et le format (<code class="docutils literal notranslate"><span class="pre">sqlite3</span></code>), laissant les autres options à leurs valeurs par défaut. Les options de conversion par défaut sont utilisées, qui n’effectueront aucune conversion et stockeront les messages dans le format de sérialisation dans lequel ils sont reçus.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">storage_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">StorageOptions</span><span class="p">(</span>
    <span class="n">uri</span><span class="o">=</span><span class="s1">&#39;my_bag&#39;</span><span class="p">,</span>
    <span class="n">storage_id</span><span class="o">=</span><span class="s1">&#39;sqlite3&#39;</span><span class="p">)</span>
<span class="n">converter_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">ConverterOptions</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">converter_options</span><span class="p">)</span>
</pre></div>
</div>
<p>Ensuite, nous devons informer l’auteur des sujets que nous souhaitons stocker. Cela se fait en créant un objet <code class="docutils literal notranslate"><span class="pre">TopicMetadata</span></code> et en l’enregistrant avec le rédacteur. Cet objet spécifie le nom de rubrique, le type de données de rubrique et le format de sérialisation utilisé.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_info</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">TopicMetadata</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;std_msgs/msg/String&#39;</span><span class="p">,</span>
    <span class="n">serialization_format</span><span class="o">=</span><span class="s1">&#39;cdr&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">topic_info</span><span class="p">)</span>
</pre></div>
</div>
<p>Le rédacteur étant désormais configuré pour enregistrer les données que nous lui transmettons, nous créons un abonnement et lui spécifions un rappel. Nous écrirons des données dans le sac dans le rappel.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_subscription</span><span class="p">(</span>
    <span class="n">String</span><span class="p">,</span>
    <span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">topic_callback</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">subscription</span>
</pre></div>
</div>
<p>Le rappel reçoit le message sous forme non sérialisée (comme c’est le cas pour l’API <code class="docutils literal notranslate"><span class="pre">rclpy</span></code>) et transmet le message à l’auteur, en spécifiant le sujet auquel les données sont destinées et l’horodatage à enregistrer avec le message. Cependant, l’écrivain a besoin d’un message sérialisé pour le stocker dans le sac. Cela signifie que nous devons sérialiser les données avant de les transmettre au rédacteur. Pour cette raison, nous appelons <code class="docutils literal notranslate"><span class="pre">serialize_message()</span></code> et transmettons le résultat à l’auteur, plutôt que de transmettre directement le message.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s1">&#39;chatter&#39;</span><span class="p">,</span>
        <span class="n">serialize_message</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>
</pre></div>
</div>
<p>Le fichier se termine par la fonction <code class="docutils literal notranslate"><span class="pre">main</span></code> utilisée pour créer une instance du nœud et démarrer le traitement par ROS.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
    <span class="n">sbr</span> <span class="o">=</span> <span class="n">SimpleBagRecorder</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">sbr</span><span class="p">)</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="add-entry-point">
<h4>2.2 Ajouter un point d’entrée<a class="headerlink" href="#add-entry-point" title="Lien permanent vers ce titre"></a></h4>
<p>Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> dans le package <code class="docutils literal notranslate"><span class="pre">bag_recorder_nodes_py</span></code> et ajoutez un point d’entrée pour votre nœud.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;simple_bag_recorder = bag_recorder_nodes_py.simple_bag_recorder:main&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">},</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-and-run">
<h3><a class="toc-backref" href="#id11">3 Construire et exécuter</a><a class="headerlink" href="#build-and-run" title="Lien permanent vers ce titre"></a></h3>
<p>Revenez à la racine de votre espace de travail, <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code>, et créez votre nouveau package.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-0-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-0-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-0-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-0-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --merge-install --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div></div>
<p>Ouvrez un nouveau terminal, accédez à <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code> et sourcez les fichiers d’installation.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-1-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-1-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-1-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-1-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">call install/setup.bat</span>
</pre></div>
</div>
</div></div>
<p>Exécutez maintenant le nœud :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run bag_recorder_nodes_py simple_bag_recorder</span>
</pre></div>
</div>
<p>Ouvrez un deuxième terminal et exécutez le nœud d’exemple <code class="docutils literal notranslate"><span class="pre">talker</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run demo_nodes_cpp talker</span>
</pre></div>
</div>
<p>Cela commencera à publier des données sur le sujet <code class="docutils literal notranslate"><span class="pre">chatter</span></code>. Au fur et à mesure que le nœud d’écriture du sac reçoit ces données, il les écrira dans le sac <code class="docutils literal notranslate"><span class="pre">my_bag</span></code>. Si le répertoire <code class="docutils literal notranslate"><span class="pre">my_bag</span></code> existe déjà, vous devez d’abord le supprimer avant d’exécuter le nœud <code class="docutils literal notranslate"><span class="pre">simple_bag_recorder</span></code>. C’est parce que <code class="docutils literal notranslate"><span class="pre">rosbag2</span></code> n’écrasera pas les sacs existants par défaut, et donc le répertoire de destination ne peut pas exister.</p>
<p>Terminez les deux nœuds. Ensuite, dans un terminal, démarrez le nœud d’exemple <code class="docutils literal notranslate"><span class="pre">listener</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run demo_nodes_cpp listener</span>
</pre></div>
</div>
<p>Dans l’autre terminal, utilisez <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">bag</span></code> pour lire le sac enregistré par votre nœud.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 bag play my_bag</span>
</pre></div>
</div>
<p>Vous verrez les messages du sac reçus par le nœud <code class="docutils literal notranslate"><span class="pre">listener</span></code>.</p>
<p>Si vous souhaitez exécuter à nouveau le nœud d’écriture de sac, vous devrez d’abord supprimer le répertoire <code class="docutils literal notranslate"><span class="pre">my_bag</span></code>.</p>
</div>
<div class="section" id="record-synthetic-data-from-a-node">
<h3><a class="toc-backref" href="#id12">4 Enregistrer les données synthétiques d’un nœud</a><a class="headerlink" href="#record-synthetic-data-from-a-node" title="Lien permanent vers ce titre"></a></h3>
<p>Toutes les données peuvent être enregistrées dans un sac, pas seulement les données reçues sur un sujet. Un cas d’utilisation courant pour écrire dans un sac à partir de votre propre nœud consiste à générer et à stocker des données synthétiques. Dans cette section, vous apprendrez à écrire un nœud qui génère des données et les stocke dans un sac. Nous allons démontrer deux approches pour ce faire. Le premier utilise un nœud avec une minuterie ; c’est l’approche que vous utiliseriez si votre génération de données est externe au nœud, comme la lecture de données directement à partir du matériel (par exemple, une caméra). La deuxième approche n’utilise pas de nœud ; c’est l’approche que vous pouvez utiliser lorsque vous n’avez pas besoin d’utiliser les fonctionnalités de l’infrastructure ROS.</p>
<div class="section" id="write-a-python-node">
<h4>4.1 Écrire un nœud Python<a class="headerlink" href="#write-a-python-node" title="Lien permanent vers ce titre"></a></h4>
<p>Dans le répertoire <code class="docutils literal notranslate"><span class="pre">ros2_ws/src/bag_recorder_nodes_py/bag_recorder_nodes_py</span></code>, créez un nouveau fichier appelé <code class="docutils literal notranslate"><span class="pre">data_generator_node.py</span></code> et collez-y le code suivant.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">rclpy.serialization</span> <span class="kn">import</span> <span class="n">serialize_message</span>
<span class="kn">from</span> <span class="nn">example_interfaces.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="kn">import</span> <span class="nn">rosbag2_py</span>

<span class="k">class</span> <span class="nc">DataGeneratorNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;data_generator_node&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">Int32</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">SequentialWriter</span><span class="p">()</span>

        <span class="n">storage_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">StorageOptions</span><span class="p">(</span>
            <span class="n">uri</span><span class="o">=</span><span class="s1">&#39;timed_synthetic_bag&#39;</span><span class="p">,</span>
            <span class="n">storage_id</span><span class="o">=</span><span class="s1">&#39;sqlite3&#39;</span><span class="p">)</span>
        <span class="n">converter_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">ConverterOptions</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">converter_options</span><span class="p">)</span>

        <span class="n">topic_info</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">TopicMetadata</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;example_interfaces/msg/Int32&#39;</span><span class="p">,</span>
            <span class="n">serialization_format</span><span class="o">=</span><span class="s1">&#39;cdr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">topic_info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
            <span class="n">serialize_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
    <span class="n">dgn</span> <span class="o">=</span> <span class="n">DataGeneratorNode</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">dgn</span><span class="p">)</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>4.2 Examiner le code<a class="headerlink" href="#id1" title="Lien permanent vers ce titre"></a></h4>
<p>Une grande partie de ce code est identique au premier exemple. Les différences importantes sont décrites ici.</p>
<p>Tout d’abord, le nom du sac est changé.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">storage_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">StorageOptions</span><span class="p">(</span>
    <span class="n">uri</span><span class="o">=</span><span class="s1">&#39;timed_synthetic_bag&#39;</span><span class="p">,</span>
    <span class="n">storage_id</span><span class="o">=</span><span class="s1">&#39;sqlite3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Le nom du sujet est également modifié, tout comme le type de données stocké.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">topic_info</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">TopicMetadata</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;example_interfaces/msg/Int32&#39;</span><span class="p">,</span>
    <span class="n">serialization_format</span><span class="o">=</span><span class="s1">&#39;cdr&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">topic_info</span><span class="p">)</span>
</pre></div>
</div>
<p>Plutôt qu’un abonnement à un sujet, ce nœud a une minuterie. Le minuteur se déclenche avec une période d’une seconde et appelle la fonction membre donnée lorsqu’il le fait.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans le rappel de la minuterie, nous générons (ou obtenons autrement, par exemple en lisant à partir d’un port série connecté à un matériel) les données que nous souhaitons stocker dans le sac. Comme dans l’exemple précédent, les données ne sont pas encore sérialisées, nous devons donc les sérialiser avant de les transmettre au rédacteur.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
    <span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
    <span class="n">serialize_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="add-executable">
<h4>4.3 Ajouter un exécutable<a class="headerlink" href="#add-executable" title="Lien permanent vers ce titre"></a></h4>
<p>Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> dans le package <code class="docutils literal notranslate"><span class="pre">bag_recorder_nodes_py</span></code> et ajoutez un point d’entrée pour votre nœud.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;simple_bag_recorder = bag_recorder_nodes_py.simple_bag_recorder:main&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data_generator_node = bag_recorder_nodes_py.data_generator_node:main&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">},</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>4.4 Construire et exécuter<a class="headerlink" href="#id2" title="Lien permanent vers ce titre"></a></h4>
<p>Revenez à la racine de votre espace de travail, <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code>, et créez votre package.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-2-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-2-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-2-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-2-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --merge-install --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div></div>
<p>Ouvrez un nouveau terminal, accédez à <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code> et sourcez les fichiers d’installation.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-3-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-3-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-3-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-3-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">call install/setup.bat</span>
</pre></div>
</div>
</div></div>
<p>Si le répertoire <code class="docutils literal notranslate"><span class="pre">timed_synthetic_bag</span></code> existe déjà, vous devez d’abord le supprimer avant d’exécuter le nœud.</p>
<p>Exécutez maintenant le nœud :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run bag_recorder_nodes_py data_generator_node</span>
</pre></div>
</div>
<p>Attendez environ 30 secondes, puis terminez le nœud avec <code class="docutils literal notranslate"><span class="pre">ctrl-c</span></code>. Ensuite, lisez le sac créé.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 bag play timed_synthetic_bag</span>
</pre></div>
</div>
<p>Ouvrez un second terminal et renvoyez le sujet <code class="docutils literal notranslate"><span class="pre">/synthetic</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 topic echo /synthetic</span>
</pre></div>
</div>
<p>Vous verrez les données générées et stockées dans le sac imprimées sur la console au rythme d’un message par seconde.</p>
</div>
</div>
<div class="section" id="record-synthetic-data-from-an-executable">
<h3><a class="toc-backref" href="#id13">5 Enregistrer des données synthétiques à partir d’un exécutable</a><a class="headerlink" href="#record-synthetic-data-from-an-executable" title="Lien permanent vers ce titre"></a></h3>
<p>Maintenant que vous pouvez créer un sac qui stocke des données à partir d’une source autre qu’un sujet, vous allez apprendre à générer et à enregistrer des données synthétiques à partir d’un exécutable non nœud. L’avantage de cette approche est un code plus simple et la création rapide d’une grande quantité de données.</p>
<div class="section" id="write-a-python-executable">
<h4>5.1 Écrire un exécutable Python<a class="headerlink" href="#write-a-python-executable" title="Lien permanent vers ce titre"></a></h4>
<p>Dans le répertoire <code class="docutils literal notranslate"><span class="pre">ros2_ws/src/bag_recorder_nodes_py/bag_recorder_nodes_py</span></code>, créez un nouveau fichier appelé <code class="docutils literal notranslate"><span class="pre">data_generator_executable.py</span></code> et collez-y le code suivant.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rclpy.clock</span> <span class="kn">import</span> <span class="n">Clock</span>
<span class="kn">from</span> <span class="nn">rclpy.duration</span> <span class="kn">import</span> <span class="n">Duration</span>
<span class="kn">from</span> <span class="nn">rclpy.serialization</span> <span class="kn">import</span> <span class="n">serialize_message</span>
<span class="kn">from</span> <span class="nn">example_interfaces.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="kn">import</span> <span class="nn">rosbag2_py</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">SequentialWriter</span><span class="p">()</span>

    <span class="n">storage_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">StorageOptions</span><span class="p">(</span>
        <span class="n">uri</span><span class="o">=</span><span class="s1">&#39;big_synthetic_bag&#39;</span><span class="p">,</span>
        <span class="n">storage_id</span><span class="o">=</span><span class="s1">&#39;sqlite3&#39;</span><span class="p">)</span>
    <span class="n">converter_options</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">ConverterOptions</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">converter_options</span><span class="p">)</span>

    <span class="n">topic_info</span> <span class="o">=</span> <span class="n">rosbag2_py</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">TopicMetadata</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;example_interfaces/msg/Int32&#39;</span><span class="p">,</span>
        <span class="n">serialization_format</span><span class="o">=</span><span class="s1">&#39;cdr&#39;</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">create_topic</span><span class="p">(</span><span class="n">topic_info</span><span class="p">)</span>

    <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">Int32</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ii</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
            <span class="n">serialize_message</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">time_stamp</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>
        <span class="n">time_stamp</span> <span class="o">+=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h4>5.2 Examiner le code<a class="headerlink" href="#id3" title="Lien permanent vers ce titre"></a></h4>
<p>Une comparaison de cet échantillon et de l’échantillon précédent révélera qu’ils ne sont pas si différents. La seule différence significative est l’utilisation d’une boucle for pour piloter la génération de données plutôt qu’un temporisateur.</p>
<p>Notez que nous générons également des horodatages pour les données plutôt que de nous fier à l’heure système actuelle pour chaque échantillon. L’horodatage peut être n’importe quelle valeur dont vous avez besoin. Les données seront lues à la vitesse donnée par ces horodatages, c’est donc un moyen utile de contrôler la vitesse de lecture par défaut des échantillons. Notez également que même si l’écart entre chaque échantillon est d’une seconde complète, cet exécutable n’a pas besoin d’attendre une seconde entre chaque échantillon. Cela nous permet de générer beaucoup de données couvrant une large période de temps en beaucoup moins de temps que la lecture ne prendra.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">time_stamp</span> <span class="o">=</span> <span class="n">Clock</span><span class="p">()</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Int32</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ii</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s1">&#39;synthetic&#39;</span><span class="p">,</span>
        <span class="n">serialize_message</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="n">time_stamp</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">)</span>
    <span class="n">time_stamp</span> <span class="o">+=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h4>5.3 Ajouter un exécutable<a class="headerlink" href="#id4" title="Lien permanent vers ce titre"></a></h4>
<p>Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> dans le package <code class="docutils literal notranslate"><span class="pre">bag_recorder_nodes_py</span></code> et ajoutez un point d’entrée pour votre nœud.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;simple_bag_recorder = bag_recorder_nodes_py.simple_bag_recorder:main&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data_generator_node = bag_recorder_nodes_py.data_generator_node:main&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data_generator_executable = bag_recorder_nodes_py.data_generator_executable:main&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">},</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h4>5.4 Construire et exécuter<a class="headerlink" href="#id5" title="Lien permanent vers ce titre"></a></h4>
<p>Revenez à la racine de votre espace de travail, <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code>, et créez votre package.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-4-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-4-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-4-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-4-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">colcon build --merge-install --packages-select bag_recorder_nodes_py</span>
</pre></div>
</div>
</div></div>
<p>Ouvrez un terminal, accédez à <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code> et sourcez les fichiers d’installation.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-5-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-5-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-5-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-5-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">call install/setup.bat</span>
</pre></div>
</div>
</div></div>
<p>Si le répertoire <code class="docutils literal notranslate"><span class="pre">big_synthetic_bag</span></code> existe déjà, vous devez d’abord le supprimer avant de lancer l’exécutable.</p>
<p>Lancez maintenant l’exécutable :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run bag_recorder_nodes_py data_generator_executable</span>
</pre></div>
</div>
<p>Notez que l’exécutable s’exécute et se termine très rapidement.</p>
<p>Rejouez maintenant le sac créé.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 bag play big_synthetic_bag</span>
</pre></div>
</div>
<p>Ouvrez un second terminal et renvoyez le sujet <code class="docutils literal notranslate"><span class="pre">/synthetic</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 topic echo /synthetic</span>
</pre></div>
</div>
<p>Vous verrez les données générées et stockées dans le sac imprimées sur la console au rythme d’un message par seconde. Même si le sac a été généré rapidement, il est toujours lu au rythme indiqué par les horodatages.</p>
</div>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id14">Résumé</a><a class="headerlink" href="#summary" title="Lien permanent vers ce titre"></a></h2>
<p>Vous avez créé un nœud qui enregistre les données qu’il reçoit sur un sujet dans un sac. Vous avez testé l’enregistrement d’un sac à l’aide du nœud et vérifié que les données ont été enregistrées en lisant le sac. Cette approche peut être utilisée pour enregistrer un sac avec des données supplémentaires à celles qu’il a reçues sur un sujet, par exemple avec des résultats obtenus à partir du traitement des données reçues. Vous avez ensuite créé un nœud et un exécutable pour générer des données synthétiques et les stocker dans un sac. Ces dernières approches sont utiles notamment pour générer des données synthétiques qui peuvent être utilisées, par exemple, comme ensembles d’apprentissage.</p>
</div>
</div>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="Recording-A-Bag-From-Your-Own-Node-CPP.html" class="btn btn-neutral float-left" title="Enregistrer un sac à partir d’un nœud (C++)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="Simulators/Simulation-Main.html" class="btn btn-neutral float-right" title="Simulation" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Open Robotics.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>