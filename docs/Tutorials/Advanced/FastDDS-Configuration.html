<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Libérer le potentiel du middleware Fast DDS [contribution de la communauté] &mdash; Documentation ROS 2 documentation </title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.ros.org/en/Tutorials/Advanced/FastDDS-Configuration.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Enregistrer un sac à partir d’un nœud (C++)" href="Recording-A-Bag-From-Your-Own-Node-CPP.html" />
    <link rel="prev" title="Implémentation d’un répartiteur de mémoire personnalisé" href="Allocator-Template-Tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> ROS 2 documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Install-Debians.html">Ubuntu (Debian)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Windows-Install-Binary.html">Windows (binaire)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/RHEL-Install-RPMs.html">RHEL (RPM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Alternatives.html">Alternatives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Development-Setup.html">gratuit (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Ubuntu-Install-Binary.html">gratuit (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Windows-Development-Setup.html">Windows (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Development-Setup.html">RHEL (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/RHEL-Install-Binary.html">RHEL (binaire)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/macOS-Development-Setup.html">mac OS (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Fedora-Development-Setup.html">Fedora (source)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/Alternatives/Latest-Development-Setup.html">Dernier développement (source)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Maintaining-a-Source-Checkout.html">Maintenir la vérification de la source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Testing.html">Tester avec des binaires de pré-version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/DDS-Implementations.html">Implémentations DDS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-Security-Plugins.html">Plugins de sécurité Connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-University-Eval.html">RTI Connect DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">Éclipse Cyclone DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-GurumNetworks-GurumDDS.html">GurumNetworks GurumDDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-eProsima-Fast-DDS.html">DDS rapide eProsima</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Releases.html">Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Humble-Hawksbill.html">Humble Hawksbill (<code class="docutils literal notranslate"><span class="pre">humble</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Humble-Hawksbill-Complete-Changelog.html">Journal des modifications de Humble Hawksbill</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Foxy-Fitzroy.html">Foxy Fitzroy (<code class="docutils literal notranslate"><span class="pre">foxy</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Rolling-Ridley.html">Rouler Ridley (<code class="docutils literal notranslate"><span class="pre">rouler</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Development.html">Développement Répartition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Iron-Irwini.html">ROS 2 Iron Irwini (nom de code “iron”; mai 2023)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/End-of-Life.html">Distributions en fin de vie</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Galactic-Geochelone.html">Géochelone Galactique (<code class="docutils literal notranslate"><span class="pre">galactique</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Releases/Galactic-Geochelone-Complete-Changelog.html">Journal des modifications de Galactic Geochelone</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html">Eloquent Elusor (``éloquent””)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Dashing-Diademata.html">Dashing Diademata (<code class="docutils literal notranslate"><span class="pre">fringant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Crystal-Clemmys.html">Cristal Clemmys (<code class="docutils literal notranslate"><span class="pre">cristal</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Bouncy-Bolson.html">Bouncy Bolson (<code class="docutils literal notranslate"><span class="pre">rebondissant</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Release-Ardent-Apalone.html">Apalone ardent (<code class="docutils literal notranslate"><span class="pre">ardent</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta3-Overview.html">Bêta 3 (<code class="docutils literal notranslate"><span class="pre">r2b3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta2-Overview.html">Bêta 2 (<code class="docutils literal notranslate"><span class="pre">r2b2</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Beta1-Overview.html">Bêta 1 (<code class="docutils literal notranslate"><span class="pre">Asphalte</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Releases/Alpha-Overview.html">Alphas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Process.html">Processus de développement d’une version</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Tutorials.html">Tutoriels</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Beginner-CLI-Tools.html">Débutant : outils CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Configuring-ROS2-Environment.html">Configuration de l’environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html">Utiliser <code class="docutils literal notranslate"><span class="pre">turtlesim</span></code> et <code class="docutils literal notranslate"><span class="pre">rqt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Nodes/Understanding-ROS2-Nodes.html">Comprendre les nœuds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Topics/Understanding-ROS2-Topics.html">Comprendre les sujets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html">Comprendre les services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html">Comprendre les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html">Comprendre les actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Using-Rqt-Console/Using-Rqt-Console.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">rqt_console</span></code> pour afficher les journaux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Launching-Multiple-Nodes/Launching-Multiple-Nodes.html">Nœuds de lancement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html">Enregistrement et lecture de données</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Beginner-Client-Libraries.html">Débutant : Bibliothèques clientes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Colcon-Tutorial.html">Utiliser <code class="docutils literal notranslate"><span class="pre">colcon</span></code> pour créer des packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html">Créer un espace de travail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html">Création d’un paquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html">Écrire un simple éditeur et abonné (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Service-And-Client.html">Ecrire un service et un client simples (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Py-Service-And-Client.html">Écrire un service et un client simples (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Custom-ROS2-Interfaces.html">Création de fichiers msg et srv personnalisés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Single-Package-Define-And-Use-Interface.html">Implémentation d’interfaces personnalisées</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Using-Parameters-In-A-Class-CPP.html">Utiliser des paramètres dans une classe (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Using-Parameters-In-A-Class-Python.html">Utiliser des paramètres dans une classe (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Getting-Started-With-Ros2doctor.html">Utiliser <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> pour identifier les problèmes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Beginner-Client-Libraries/Pluginlib.html">Créer et utiliser des plugins (C++)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Intermediate.html">Intermédiaire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Rosdep.html">Gestion des dépendances avec rosdep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Creating-an-Action.html">Créer une action</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Writing-an-Action-Server-Client/Cpp.html">Ecriture d’un serveur d’action et d’un client (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Writing-an-Action-Server-Client/Py.html">Ecriture d’un serveur d’action et d’un client (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Composition.html">Composer plusieurs nœuds en un seul processus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Monitoring-For-Parameter-Changes-CPP.html">Surveillance des changements de paramètres (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Launch/Launch-Main.html">Lancement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Creating-Launch-Files.html">Création d’un fichier de lancement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Launch-system.html">Intégration des fichiers de lancement dans les packages ROS 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-Substitutions.html">Utiliser des substitutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-Event-Handlers.html">Utilisation des gestionnaires d’événements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Launch/Using-ROS2-Launch-For-Large-Projects.html">Gestion de grands projets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Tf2/Tf2-Main.html">tracé</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Introduction-To-Tf2.html">Présentation de <code class="docutils literal notranslate"><span class="pre">tf2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Py.html">Écrire un diffuseur statique (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Static-Broadcaster-Cpp.html">Écrire un diffuseur statique (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Py.html">Écrire un diffuseur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Broadcaster-Cpp.html">Ecrire un diffuseur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Listener-Py.html">Écrire un écouteur (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Writing-A-Tf2-Listener-Cpp.html">Écrire un écouteur (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Adding-A-Frame-Py.html">Ajouter un cadre (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Adding-A-Frame-Cpp.html">Ajouter un cadre (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Learning-About-Tf2-And-Time-Py.html">Utiliser le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Learning-About-Tf2-And-Time-Cpp.html">Utilisation du temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Time-Travel-With-Tf2-Py.html">Voyager dans le temps (Python)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Time-Travel-With-Tf2-Cpp.html">Voyager dans le temps (C++)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Debugging-Tf2-Problems.html">Débogage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Quaternion-Fundamentals.html">Fondamentaux du quaternion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Tf2/Using-Stamped-Datatypes-With-Tf2-Ros-MessageFilter.html">Utiliser des types de données tamponnés avec <code class="docutils literal notranslate"><span class="pre">tf2_ros::MessageFilter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/Testing/Testing-Main.html">Essai</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Testing/CLI.html">Exécution de tests dans ROS 2 à partir de la ligne de commande</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/Testing/Python.html">Écrire des tests de base avec Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Intermediate/URDF/URDF-Main.html">URDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Building-a-Visual-Robot-Model-with-URDF-from-Scratch.html">Construire un modèle de robot visuel à partir de zéro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Building-a-Movable-Robot-Model-with-URDF.html">Construire un modèle de robot mobile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model.html">Ajout de propriétés physiques et de collision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Using-Xacro-to-Clean-Up-a-URDF-File.html">Utiliser Xacro pour nettoyer votre code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intermediate/URDF/Using-URDF-with-Robot-State-Publisher.html">Utiliser URDF avec <code class="docutils literal notranslate"><span class="pre">robot_state_publisher</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../Advanced.html">Avancé</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Topic-Statistics-Tutorial/Topic-Statistics-Tutorial.html">Activation des statistiques de sujet (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Discovery-Server/Discovery-Server.html">Utilisation de Fast DDS Discovery Server comme protocole de découverte [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="Allocator-Template-Tutorial.html">Implémentation d’un répartiteur de mémoire personnalisé</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Libérer le potentiel du middleware Fast DDS [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="Recording-A-Bag-From-Your-Own-Node-CPP.html">Enregistrer un sac à partir d’un nœud (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Recording-A-Bag-From-Your-Own-Node-Py.html">Enregistrer un sac à partir d’un nœud (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Simulators/Simulation-Main.html">Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Simulators/Webots.html">Mise en place d’une simulation de robot (Webots)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Simulators/Gazebo.html">Mise en place d’une simulation de robot (Gazebo)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Security/Security-Main.html">Sécurité</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Security/Introducing-ros2-security.html">Mise en place de la sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/The-Keystore.html">Comprendre le magasin de clés de sécurité</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Security-on-Two.html">Garantir la sécurité sur toutes les machines</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Examine-Traffic.html">Examen du trafic réseau</a></li>
<li class="toctree-l4"><a class="reference internal" href="Security/Access-Controls.html">Paramétrage des contrôles d’accès</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Demos.html">Démos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Quality-of-Service.html">Utilisation des paramètres de qualité de service pour les réseaux avec perte</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Managed-Nodes.html">Gestion des nœuds avec des cycles de vie gérés</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Intra-Process-Communication.html">Mettre en place une communication intra-process efficace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Rosbag-with-ROS1-Bridge.html">Enregistrement et lecture de données avec <code class="docutils literal notranslate"><span class="pre">rosbag</span></code> en utilisant le pont ROS 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Real-Time-Programming.html">Comprendre la programmation temps réel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/dummy-robot-demo.html">Expérimenter avec un robot factice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Logging-and-logger-configuration.html">Enregistrement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Demos/Content-Filtering-Subscription.html">Création d’un abonnement au filtrage de contenu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Miscellaneous.html">Divers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Deploying-ROS-2-on-IBM-Cloud.html">Déploiement sur IBM Cloud Kubernetes [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Eclipse-Oxygen-with-ROS-2-and-rviz2.html">Utiliser Eclipse Oxygen avec <code class="docutils literal notranslate"><span class="pre">rviz2</span></code> [community-contributed]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Building-Realtime-rt_preempt-kernel-for-ROS-2.html">Construire un noyau Linux en temps réel [contribution de la communauté]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Miscellaneous/Building-ROS2-Package-with-eclipse-2021-06.html">Construire un package avec Eclipse 2021-06</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../How-To-Guides.html">Guides pratiques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installation-Troubleshooting.html">Dépannage de l’installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Developing-a-ROS-2-Package.html">Développement d’un package ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Documentation.html">documentation utilisateur ament_cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Python-Documentation.html">documentation utilisateur ament_cmake_python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-files-migration-guide.html">Migration des fichiers de lancement de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-file-different-formats.html">Utilisation de Python, XML et YAML pour les fichiers de lancement ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launching-composable-nodes.html">Utilisation du lancement de ROS 2 pour lancer des nœuds composables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html">Migration des fichiers de paramètres YAML de ROS 1 vers ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Node-arguments.html">Passer des arguments ROS aux nœuds via la ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Sync-Vs-Async.html">Clients de service synchrones ou asynchrones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/DDS-tuning.html">Informations de réglage DDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Overriding-QoS-Policies-For-Recording-And-Playback.html">rosbag2 : Remplacement des politiques de QoS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Working-with-multiple-RMW-implementations.html">Travailler avec plusieurs implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Cross-compilation.html">Compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Releasing/Releasing-a-Package.html">Libérer un paquet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/First-Time-Release.html">Première sortie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Subsequent-Releases.html">Versions ultérieures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Team-Repository.html">Équipe de publication / Référentiel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/Releasing/Release-Track.html">Piste de sortie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Python-Packages.html">Utilisation de packages Python avec ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Port-Plugin-Windows.html">Portage des plugins RQt vers Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Run-2-nodes-in-single-or-separate-docker-containers.html">Exécution de nœuds ROS 2 dans Docker [contribution de la communauté]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Visualizing-ROS-2-Data-With-Foxglove-Studio.html">Visualiser les données ROS 2 avec Foxglove Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Package-maintainer-guide.html">Guide du responsable du paquet ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-a-Custom-Debian-Package.html">Construire un paquet Debian personnalisé</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-ROS-2-with-Tracing-Instrumentation.html">Construire ROS 2 avec instrumentation de traçage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Topics-Services-Actions.html">Sujets vs Services vs Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Variants.html">Utiliser des variantes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros2-param.html">Utilisation de l’outil de ligne de commande <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros1_bridge-Jammy-upstream.html">Utilisation de <code class="docutils literal notranslate"><span class="pre">ros1_bridge</span></code> avec ROS en amont sur Ubuntu 22.04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Disabling-ZeroCopy-loaned-messages.html">Désactivation des messages prêtés sans copie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installing-on-Raspberry-Pi.html">ROS 2 sur Raspberry Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-callback-groups.html">Utilisation des groupes de rappel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install.html">Construire RQt à partir de la source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-MacOS.html">Construire RQt à partir de la source sur macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-Windows10.html">Construire RQt à partir de la source sur Windows 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Concepts.html">Notions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Domain-ID.html">Le ROS_DOMAIN_ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Different-Middleware-Vendors.html">À propos des différents fournisseurs ROS 2 DDS/RTPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Logging.html">À propos de la journalisation et de la configuration de l’enregistreur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html">À propos des paramètres de qualité de service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-Interfaces.html">À propos des interfaces ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Parameters.html">À propos des paramètres dans ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Executors.html">Exécuteurs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Topic-Statistics.html">À propos des statistiques de sujet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Command-Line-Tools.html">Introspection avec des outils en ligne de commande</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-RQt.html">Présentation et utilisation de RQt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Composition.html">À propos de la composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Catment.html">Sur le mélange d’ament et de chaton (catment)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Cross-Compilation.html">À propos de la compilation croisée</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Security.html">À propos de la sécurité ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Tf2.html">À propos de TF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Build-System.html">À propos du système de construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Internal-Interfaces.html">À propos des interfaces ROS 2 internes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Middleware-Implementations.html">À propos des implémentations de middleware ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">À propos des bibliothèques clientes ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contacter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../The-ROS2-Project.html">Le projet ROS 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Contributing.html">Contribuant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Developer-Guide.html">Guide du développeur ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Code-Style-Language-Versions.html">Style de code et versions linguistiques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Quality-Guide.html">Guide qualité : assurer la qualité du code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Migration-Guide.html">Guide de migration depuis ROS 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Migration-Guide-Python.html">Guide de migration Python depuis ROS 1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Build-Farms.html">Fermes de construction ROS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Windows-Tips-and-Tricks.html">Trucs et astuces Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Contributing/Contributing-To-ROS-2-Documentation.html">Contribuer à la documentation ROS 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Features.html">Statut des fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Feature-Ideas.html">Idées de fonctionnalités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Roadmap.html">Feuille de route</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/ROSCon-Content.html">Pourparlers ROSCon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Governance.html">Gouvernance du projet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/ROS2-TSC-Charter.html">Charte du comité de pilotage technique ROS 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/ROS2-TSC-Intake-process.html">Processus d’admission des candidats ROS 2 TSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../The-ROS2-Project/Governance/How-To-Start-A-Community-Working-Group.html">Comment démarrer un groupe de travail communautaire</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../The-ROS2-Project/Marketing.html">Commercialisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Related-Projects.html">Projets liés</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Intel-ROS2-Projects.html">Projets Intel ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Nvidia-ROS2-Projects.html">Projets NVIDIA ROS 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Citations.html">Citations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ROS 2 documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../Tutorials.html">Tutoriels</a></li>
          <li class="breadcrumb-item"><a href="../Advanced.html">Avancé</a></li>
      <li class="breadcrumb-item active">Libérer le potentiel du middleware Fast DDS [contribution de la communauté]</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros2/ros2_documentation/blob/rolling/source/Tutorials/Advanced/FastDDS-Configuration.rst" class="fa fa-github"> Éditer sur GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <div class="section" id="unlocking-the-potential-of-fast-dds-middleware-community-contributed">
<h1>Libérer le potentiel du middleware Fast DDS [contribution de la communauté]<a class="headerlink" href="#unlocking-the-potential-of-fast-dds-middleware-community-contributed" title="Lien permanent vers ce titre"></a></h1>
<p><strong>Objectif :</strong> Ce didacticiel vous montrera comment utiliser les capacités de configuration étendues de Fast DDS dans ROS 2.</p>
<p><strong>Niveau du didacticiel :</strong> Avancé</p>
<p><strong>Durée :</strong> 20 minutes</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table des matières</p>
<ul class="simple">
<li><p><a class="reference internal" href="#background" id="id1">Arrière-plan</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id2">Conditions préalables</a></p></li>
<li><p><a class="reference internal" href="#mixing-synchronous-and-asynchronous-publications-in-the-same-node" id="id3">Mélanger des publications synchrones et asynchrones dans un même nœud</a></p>
<ul>
<li><p><a class="reference internal" href="#create-the-node-with-the-publishers" id="id4">Créer le nœud avec les éditeurs</a></p></li>
<li><p><a class="reference internal" href="#create-the-xml-file-with-the-profile-configuration" id="id5">Créer le fichier XML avec la configuration du profil</a></p></li>
<li><p><a class="reference internal" href="#execute-the-publisher-node" id="id6">Exécuter le nœud de l’éditeur</a></p></li>
<li><p><a class="reference internal" href="#create-a-node-with-the-subscribers" id="id7">Créer un nœud avec les abonnés</a></p></li>
<li><p><a class="reference internal" href="#add-the-subscriber-profiles-to-the-the-xml" id="id8">Ajouter les profils d’abonnés au XML</a></p></li>
<li><p><a class="reference internal" href="#execute-the-subscriber-node" id="id9">Exécuter le nœud d’abonné</a></p></li>
<li><p><a class="reference internal" href="#analysis-of-the-example" id="id10">Analyse de l’exemple</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-other-fastdds-capabilities-with-xml" id="id11">Utilisation d’autres fonctionnalités FastDDS avec XML</a></p>
<ul>
<li><p><a class="reference internal" href="#limiting-the-number-of-matching-subscribers" id="id12">Limiter le nombre d’abonnés correspondants</a></p></li>
<li><p><a class="reference internal" href="#using-partitions-within-the-topic" id="id13">Utilisation de partitions dans le sujet</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuring-a-service-and-a-client" id="id14">Configurer un service et un client</a></p>
<ul>
<li><p><a class="reference internal" href="#create-the-nodes-with-the-service-and-client" id="id15">Créer les nœuds avec le service et le client</a></p></li>
<li><p><a class="reference internal" href="#create-the-xml-profiles-for-the-service-and-client" id="id16">Créer les profils XML pour le service et le client</a></p></li>
<li><p><a class="reference internal" href="#execute-the-nodes" id="id17">Exécuter les nœuds</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="background">
<h2><a class="toc-backref" href="#id1">Arrière-plan</a><a class="headerlink" href="#background" title="Lien permanent vers ce titre"></a></h2>
<p>L’interface entre la pile ROS 2 et <em>Fast DDS</em> est fournie par l’implémentation du middleware ROS 2 <a class="reference external" href="https://github.com/ros2/rmw_fastrtps">rmw_fastrtps</a>. Cette implémentation est disponible dans toutes les distributions ROS 2, à la fois des binaires et des sources.</p>
<p>ROS 2 RMW ne permet que la configuration de certains middleware QoS (voir <a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html"><span class="doc">Politiques de QoS ROS 2</span></a>). Cependant, <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code> offre des capacités de configuration étendues pour tirer pleinement parti des fonctionnalités de <em>Fast DDS</em>. Ce didacticiel vous guidera à travers une série d’exemples expliquant comment utiliser des fichiers XML pour déverrouiller cette configuration étendue.</p>
<p>Afin d’obtenir plus d’informations sur l’utilisation de <em>Fast DDS</em> sur ROS 2, veuillez consulter la <code class="xref any docutils literal notranslate"><span class="pre">documentation</span> <span class="pre">suivante</span></code> __.</p>
</div>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#id2">Conditions préalables</a><a class="headerlink" href="#prerequisites" title="Lien permanent vers ce titre"></a></h2>
<p>Ce didacticiel suppose que vous savez comment <a class="reference internal" href="../Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html"><span class="doc">créer un package</span></a>. Cela suppose également que vous savez écrire un <a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html"><span class="doc">simple publisher and subscriber</span></a> et un <a class="reference internal" href="../Beginner-Client-Libraries/Writing-A-Simple-Cpp-Service-And-Client.html"><span class="doc">simple service et client</span></a>. Bien que les exemples soient implémentés en C++, les mêmes concepts s’appliquent aux packages Python.</p>
</div>
<div class="section" id="mixing-synchronous-and-asynchronous-publications-in-the-same-node">
<h2><a class="toc-backref" href="#id3">Mélanger des publications synchrones et asynchrones dans un même nœud</a><a class="headerlink" href="#mixing-synchronous-and-asynchronous-publications-in-the-same-node" title="Lien permanent vers ce titre"></a></h2>
<p>Dans ce premier exemple, un nœud avec deux éditeurs, l’un avec un mode de publication synchrone et l’autre avec un mode de publication asynchrone, sera créé.</p>
<p><code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code> utilise le mode de publication asynchrone par défaut. Lorsque l’éditeur invoque l’opération d’écriture, les données sont copiées dans une file d’attente, un thread d’arrière-plan (thread asynchrone) est informé de l’ajout à la file d’attente et le contrôle du thread est rendu à l’utilisateur avant que les données ne soient réellement envoyées. Le thread d’arrière-plan est chargé de consommer la file d’attente et d’envoyer les données à chaque lecteur correspondant.</p>
<p>En revanche, avec le mode de publication synchrone, les données sont envoyées directement dans le contexte du thread utilisateur. Cela implique que tout appel bloquant survenant pendant l’opération d’écriture bloquerait le thread utilisateur, empêchant ainsi l’application de continuer son fonctionnement. Cependant, ce mode donne généralement des débits plus élevés à des latences plus faibles, car il n’y a pas de notification ni de changement de contexte entre les threads.</p>
<div class="section" id="create-the-node-with-the-publishers">
<h3><a class="toc-backref" href="#id4">Créer le nœud avec les éditeurs</a><a class="headerlink" href="#create-the-node-with-the-publishers" title="Lien permanent vers ce titre"></a></h3>
<p>Tout d’abord, créez un nouveau package nommé <code class="docutils literal notranslate"><span class="pre">sync_async_node_example_cpp</span></code> sur un nouvel espace de travail :</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-0-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-0-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-0-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-0-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir -p ~/ros2_ws/src</span>
<span class="go">cd ~/ros2_ws/src</span>
<span class="go">ros2 pkg create --build-type ament_cmake --dependencies rclcpp std_msgs -- sync_async_node_example_cpp</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir -p ~/ros2_ws/src</span>
<span class="go">cd ~/ros2_ws/src</span>
<span class="go">ros2 pkg create --build-type ament_cmake --dependencies rclcpp std_msgs -- sync_async_node_example_cpp</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">md \ros2_ws\src</span>
<span class="go">cd \ros2_ws\src</span>
<span class="go">ros2 pkg create --build-type ament_cmake --dependencies rclcpp std_msgs -- sync_async_node_example_cpp</span>
</pre></div>
</div>
</div></div>
<p>Ensuite, ajoutez un fichier nommé <code class="docutils literal notranslate"><span class="pre">src/sync_async_writer.cpp</span></code> au package, avec le contenu suivant. Notez que l’éditeur synchrone publiera sur le sujet <code class="docutils literal notranslate"><span class="pre">sync_topic</span></code>, tandis que l’éditeur asynchrone publiera sur le sujet <code class="docutils literal notranslate"><span class="pre">async_topic</span></code>.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;chrono&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;functional&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="o">::</span><span class="nn">chrono_literals</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SyncAsyncPublisher</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">SyncAsyncPublisher</span><span class="p">()</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="s">&quot;sync_async_publisher&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">count_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create the synchronous publisher on topic &#39;sync_topic&#39;</span>
<span class="w">        </span><span class="n">sync_publisher_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;sync_topic&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Create the asynchronous publisher on topic &#39;async_topic&#39;</span>
<span class="w">        </span><span class="n">async_publisher_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;async_topic&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// This timer will trigger the publication of new data every half a second</span>
<span class="w">        </span><span class="n">timer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_wall_timer</span><span class="p">(</span>
<span class="w">                </span><span class="mi">500</span><span class="n">ms</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SyncAsyncPublisher</span><span class="o">::</span><span class="n">timer_callback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Actions to run every time the timer expires</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">timer_callback</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create a new message to be sent</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">sync_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="p">();</span>
<span class="w">        </span><span class="n">sync_message</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SYNC: Hello, world! &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">count_</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Log the message to the console to show progress</span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Synchronously publishing: &#39;%s&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sync_message</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

<span class="w">        </span><span class="c1">// Publish the message using the synchronous publisher</span>
<span class="w">        </span><span class="n">sync_publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">sync_message</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Create a new message to be sent</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">async_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="p">();</span>
<span class="w">        </span><span class="n">async_message</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ASYNC: Hello, world! &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">count_</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Log the message to the console to show progress</span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Asynchronously publishing: &#39;%s&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">async_message</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

<span class="w">        </span><span class="c1">// Publish the message using the asynchronous publisher</span>
<span class="w">        </span><span class="n">async_publisher_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">async_message</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Prepare the count for the next message</span>
<span class="w">        </span><span class="n">count_</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// This timer will trigger the publication of new data every half a second</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">TimerBase</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">timer_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// A publisher that publishes asynchronously</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">async_publisher_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// A publisher that publishes synchronously</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">sync_publisher_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Number of messages sent so far</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count_</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">SyncAsyncPublisher</span><span class="o">&gt;</span><span class="p">());</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ouvrez maintenant le fichier <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> et ajoutez un nouvel exécutable et nommez-le <code class="docutils literal notranslate"><span class="pre">SyncAsyncWriter</span></code> afin que vous puissiez exécuter votre nœud en utilisant <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">SyncAsyncWriter</span><span class="w"> </span><span class="s">src/sync_async_writer.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">SyncAsyncWriter</span><span class="w"> </span><span class="s">rclcpp</span><span class="w"> </span><span class="s">std_msgs</span><span class="p">)</span>
</pre></div>
</div>
<p>Enfin, ajoutez la section <code class="docutils literal notranslate"><span class="pre">install(TARGETS…)</span></code> pour que <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code> puisse trouver votre exécutable :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">    </span><span class="s">SyncAsyncWriter</span>
<span class="w">    </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>Vous pouvez nettoyer votre <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> en supprimant certaines sections et commentaires inutiles, il ressemble donc à ceci :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.8</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">sync_async_node_example_cpp</span><span class="p">)</span>

<span class="c"># Default to C++14</span>
<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">std_msgs</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>

<span class="nb">add_executable</span><span class="p">(</span><span class="s">SyncAsyncWriter</span><span class="w"> </span><span class="s">src/sync_async_writer.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">SyncAsyncWriter</span><span class="w"> </span><span class="s">rclcpp</span><span class="w"> </span><span class="s">std_msgs</span><span class="p">)</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">    </span><span class="s">SyncAsyncWriter</span>
<span class="w">    </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>

<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p>Si ce nœud est créé et exécuté maintenant, les deux éditeurs se comporteront de la même manière, en publiant de manière asynchrone dans les deux rubriques, car il s’agit du mode de publication par défaut. La configuration par défaut du mode de publication peut être modifiée en runtime lors du lancement du nœud, à l’aide d’un fichier XML.</p>
</div>
<div class="section" id="create-the-xml-file-with-the-profile-configuration">
<h3><a class="toc-backref" href="#id5">Créer le fichier XML avec la configuration du profil</a><a class="headerlink" href="#create-the-xml-file-with-the-profile-configuration" title="Lien permanent vers ce titre"></a></h3>
<p>Créez un fichier avec le nom <code class="docutils literal notranslate"><span class="pre">SyncAsync.xml</span></code> et le contenu suivant :</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;profiles</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.eprosima.com/XMLSchemas/fastRTPS_Profiles&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- default publisher profile --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;default_publisher&quot;</span><span class="w"> </span><span class="na">is_default_profile=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- publisher profile for topic sync_topic --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;/sync_topic&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">        </span><span class="nt">&lt;qos&gt;</span>
<span class="w">            </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">                </span><span class="nt">&lt;kind&gt;</span>SYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">            </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/qos&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- publisher profile for topic async_topic --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;/async_topic&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">        </span><span class="nt">&lt;qos&gt;</span>
<span class="w">            </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">                </span><span class="nt">&lt;kind&gt;</span>ASYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">            </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/qos&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="w"> </span><span class="nt">&lt;/profiles&gt;</span>
</pre></div>
</div>
<p>Notez que plusieurs profils d’éditeurs sont définis. Un profil par défaut qui est défini en définissant <code class="docutils literal notranslate"><span class="pre">is_default_profile</span></code> sur <code class="docutils literal notranslate"><span class="pre">true</span></code>, et deux profils avec des noms qui coïncident avec ceux des sujets précédemment définis : <code class="docutils literal notranslate"><span class="pre">sync_topic</span></code> et un autre pour <code class="docutils literal notranslate"><span class="pre">async_topic</span></code>. Ces deux derniers profils définissent le mode de publication sur <code class="docutils literal notranslate"><span class="pre">SYNCHRONOUS</span></code> ou <code class="docutils literal notranslate"><span class="pre">ASYNCHRONOUS</span></code> selon le cas. Notez également que tous les profils spécifient une valeur <code class="docutils literal notranslate"><span class="pre">historyMemoryPolicy</span></code>, qui est nécessaire pour que l’exemple fonctionne, et la raison sera expliquée plus tard dans ce tutoriel.</p>
</div>
<div class="section" id="execute-the-publisher-node">
<h3><a class="toc-backref" href="#id6">Exécuter le nœud de l’éditeur</a><a class="headerlink" href="#execute-the-publisher-node" title="Lien permanent vers ce titre"></a></h3>
<p>Vous devrez exporter les variables d’environnement suivantes pour que le XML soit chargé :</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-1-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-1-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-1-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-1-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">SET RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">SET RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">SET FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div></div>
<p>Enfin, assurez-vous d’avoir sourcé vos fichiers de configuration et exécutez le nœud :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
<span class="go">ros2 run sync_async_node_example_cpp SyncAsyncWriter</span>
</pre></div>
</div>
<p>Vous devriez voir les éditeurs envoyer les données depuis le nœud de publication, comme suit :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612972049.994630332] [sync_async_publisher]: Synchronously publishing: &#39;SYNC: Hello, world! 0&#39;</span>
<span class="go">[INFO] [1612972049.995097767] [sync_async_publisher]: Asynchronously publishing: &#39;ASYNC: Hello, world! 0&#39;</span>
<span class="go">[INFO] [1612972050.494478706] [sync_async_publisher]: Synchronously publishing: &#39;SYNC: Hello, world! 1&#39;</span>
<span class="go">[INFO] [1612972050.494664334] [sync_async_publisher]: Asynchronously publishing: &#39;ASYNC: Hello, world! 1&#39;</span>
<span class="go">[INFO] [1612972050.994368474] [sync_async_publisher]: Synchronously publishing: &#39;SYNC: Hello, world! 2&#39;</span>
<span class="go">[INFO] [1612972050.994549851] [sync_async_publisher]: Asynchronously publishing: &#39;ASYNC: Hello, world! 2&#39;</span>
</pre></div>
</div>
<p>Vous avez maintenant un éditeur synchrone et un éditeur asynchrone exécutés dans le même nœud.</p>
</div>
<div class="section" id="create-a-node-with-the-subscribers">
<h3><a class="toc-backref" href="#id7">Créer un nœud avec les abonnés</a><a class="headerlink" href="#create-a-node-with-the-subscribers" title="Lien permanent vers ce titre"></a></h3>
<p>Ensuite, un nouveau nœud avec les abonnés qui écouteront les publications <code class="docutils literal notranslate"><span class="pre">sync_topic</span></code> et <code class="docutils literal notranslate"><span class="pre">async_topic</span></code> va être créé. Dans un nouveau fichier source nommé <code class="docutils literal notranslate"><span class="pre">src/sync_async_reader.cpp</span></code> écrivez le contenu suivant :</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;functional&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SyncAsyncSubscriber</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>

<span class="w">    </span><span class="n">SyncAsyncSubscriber</span><span class="p">()</span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="s">&quot;sync_async_subscriber&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create the synchronous subscriber on topic &#39;sync_topic&#39;</span>
<span class="w">        </span><span class="c1">// and tie it to the topic_callback</span>
<span class="w">        </span><span class="n">sync_subscription_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">            </span><span class="s">&quot;sync_topic&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SyncAsyncSubscriber</span><span class="o">::</span><span class="n">topic_callback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>

<span class="w">        </span><span class="c1">// Create the asynchronous subscriber on topic &#39;async_topic&#39;</span>
<span class="w">        </span><span class="c1">// and tie it to the topic_callback</span>
<span class="w">        </span><span class="n">async_subscription_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">            </span><span class="s">&quot;async_topic&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SyncAsyncSubscriber</span><span class="o">::</span><span class="n">topic_callback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Actions to run every time a new message is received</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">topic_callback</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;I heard: &#39;%s&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// A subscriber that listens to topic &#39;sync_topic&#39;</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">sync_subscription_</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// A subscriber that listens to topic &#39;async_topic&#39;</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">async_subscription_</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">SyncAsyncSubscriber</span><span class="o">&gt;</span><span class="p">());</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> et ajoutez un nouvel exécutable et nommez-le <code class="docutils literal notranslate"><span class="pre">SyncAsyncReader</span></code> sous le précédent <code class="docutils literal notranslate"><span class="pre">SyncAsyncWriter</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">SyncAsyncReader</span><span class="w"> </span><span class="s">src/sync_async_reader.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">SyncAsyncReader</span><span class="w"> </span><span class="s">rclcpp</span><span class="w"> </span><span class="s">std_msgs</span><span class="p">)</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">    </span><span class="s">SyncAsyncReader</span>
<span class="w">    </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="add-the-subscriber-profiles-to-the-the-xml">
<h3><a class="toc-backref" href="#id8">Ajouter les profils d’abonnés au XML</a><a class="headerlink" href="#add-the-subscriber-profiles-to-the-the-xml" title="Lien permanent vers ce titre"></a></h3>
<p>Les profils de configuration des abonnés peuvent être ajoutés dans le même fichier XML <code class="docutils literal notranslate"><span class="pre">SyncAsync.xml</span></code>. Pour le moment, seul le profil par défaut sera défini. Les profils d’abonnés seront étendus ultérieurement. Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">SyncAsync.xml</span></code> et ajoutez les profils suivants dans la balise <code class="docutils literal notranslate"><span class="pre">&lt;profiles&gt;</span></code> :</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- subscriber profile for topic sync_topic --&gt;</span>
<span class="nt">&lt;subscriber</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;default_subscriber&quot;</span><span class="w"> </span><span class="na">is_default_profile=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="nt">&lt;/subscriber&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-the-subscriber-node">
<h3><a class="toc-backref" href="#id9">Exécuter le nœud d’abonné</a><a class="headerlink" href="#execute-the-subscriber-node" title="Lien permanent vers ce titre"></a></h3>
<p>Avec le nœud d’éditeur en cours d’exécution dans un terminal, ouvrez-en un autre et exportez les variables d’environnement requises pour que le XML soit chargé :</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-2-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-2-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-2-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-2-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">SET RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">SET RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">SET FASTRTPS_DEFAULT_PROFILES_FILE=path/to/SyncAsync.xml</span>
</pre></div>
</div>
</div></div>
<p>Enfin, assurez-vous d’avoir sourcé vos fichiers de configuration et exécutez le nœud :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source install/setup.bash</span>
<span class="go">ros2 run sync_async_node_example_cpp SyncAsyncReader</span>
</pre></div>
</div>
<p>Vous devriez voir les abonnés recevoir les données du nœud de publication, comme suit :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612972054.495429090] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 10&#39;</span>
<span class="go">[INFO] [1612972054.995410057] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 10&#39;</span>
<span class="go">[INFO] [1612972055.495453494] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 11&#39;</span>
<span class="go">[INFO] [1612972055.995396561] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 11&#39;</span>
<span class="go">[INFO] [1612972056.495534818] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 12&#39;</span>
<span class="go">[INFO] [1612972056.995473953] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 12&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="analysis-of-the-example">
<h3><a class="toc-backref" href="#id10">Analyse de l’exemple</a><a class="headerlink" href="#analysis-of-the-example" title="Lien permanent vers ce titre"></a></h3>
<div class="section" id="configuration-profiles-xml">
<h4>Profils de configuration XML<a class="headerlink" href="#configuration-profiles-xml" title="Lien permanent vers ce titre"></a></h4>
<p>Le fichier XML définit plusieurs configurations pour les éditeurs et les abonnés. Vous pouvez avoir un profil de configuration d’éditeur par défaut et plusieurs profils d’éditeur spécifiques à un sujet. La seule exigence est que tous les profils d’éditeur aient un nom différent et qu’il n’y ait qu’un seul profil par défaut. Il en va de même pour les abonnés.</p>
<p>Afin de définir une configuration pour un sujet spécifique, nommez simplement le profil après le nom du sujet ROS 2 (comme <code class="docutils literal notranslate"><span class="pre">/sync_topic</span></code> et <code class="docutils literal notranslate"><span class="pre">/async_topic</span></code> dans l’exemple), et <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code> s’appliquera ce profil à tous les éditeurs et abonnés pour ce sujet. Le profil de configuration par défaut est identifié par l’attribut <code class="docutils literal notranslate"><span class="pre">is_default_profile</span></code> défini sur <code class="docutils literal notranslate"><span class="pre">true</span></code>, et agit comme un profil de secours lorsqu’il n’y en a pas d’autre avec un nom correspondant au nom du sujet.</p>
<p>La variable d’environnement <code class="docutils literal notranslate"><span class="pre">FASTRTPS_DEFAULT_PROFILES_FILE</span></code> est utilisée pour informer <em>Fast DDS</em> du chemin vers le fichier XML avec les profils de configuration à charger.</p>
</div>
<div class="section" id="rmw-fastrtps-use-qos-from-xml">
<h4>RMW_FASTRTPS_USE_QOS_FROM_XML<a class="headerlink" href="#rmw-fastrtps-use-qos-from-xml" title="Lien permanent vers ce titre"></a></h4>
<p>Parmi tous les attributs configurables, <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code> traite <code class="docutils literal notranslate"><span class="pre">publishMode</span></code> et <code class="docutils literal notranslate"><span class="pre">historyMemoryPolicy</span></code> différemment. Par défaut, ces valeurs sont définies sur <code class="docutils literal notranslate"><span class="pre">ASYNCHRONOUS</span></code> et <code class="docutils literal notranslate"><span class="pre">PREALLOCATED_WITH_REALLOC</span></code> dans l’implémentation <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code>, et les valeurs définies sur le fichier XML sont ignorées. Afin d’utiliser les valeurs du fichier XML, la variable d’environnement <code class="docutils literal notranslate"><span class="pre">RMW_FASTRTPS_USE_QOS_FROM_XML</span></code> doit être définie sur <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>Cependant, cela implique <strong>une autre mise en garde</strong> : si <code class="docutils literal notranslate"><span class="pre">RMW_FASTRTPS_USE_QOS_FROM_XML</span></code> est défini, mais que le fichier XML ne définit pas <code class="docutils literal notranslate"><span class="pre">publishMode</span></code> ou <code class="docutils literal notranslate"><span class="pre">historyMemoryPolicy</span></code>, ces attributs prennent la valeur par défaut <em>Fast DDS</em> à la place de la valeur par défaut de <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code>. Ceci est important, en particulier pour <code class="docutils literal notranslate"><span class="pre">historyMemoryPolicy</span></code>, car la valeur par défaut <em>Fast DDS</em> est <code class="docutils literal notranslate"><span class="pre">PREALLOCATED</span></code> qui ne fonctionne pas avec les types de données de sujet ROS2. Par conséquent, dans l’exemple, une valeur valide pour cette stratégie a été explicitement définie (<code class="docutils literal notranslate"><span class="pre">DYNAMIC</span></code>).</p>
</div>
<div class="section" id="prioritization-of-rmw-qos-profile-t">
<h4>Priorisation de rmw_qos_profile_t<a class="headerlink" href="#prioritization-of-rmw-qos-profile-t" title="Lien permanent vers ce titre"></a></h4>
<p>La qualité de service ROS 2 contenue dans <a class="reference external" href="http://docs.ros2.org/latest/api/rmw/structrmw__qos__profile__t.html">rmw_qos_profile_t</a> est toujours respectée, sauf si elle est définie sur <code class="docutils literal notranslate"><span class="pre">*_SYSTEM_DEFAULT</span></code>. Dans ce cas, les valeurs XML (ou les valeurs par défaut <em>Fast DDS</em> en l’absence de XML) sont appliquées. Cela signifie que si une QoS dans <code class="docutils literal notranslate"><span class="pre">rmw_qos_profile_t</span></code> est définie sur autre chose que <code class="docutils literal notranslate"><span class="pre">*_SYSTEM_DEFAULT</span></code>, la valeur correspondante dans le XML est ignorée.</p>
</div>
</div>
</div>
<div class="section" id="using-other-fastdds-capabilities-with-xml">
<h2><a class="toc-backref" href="#id11">Utilisation d’autres fonctionnalités FastDDS avec XML</a><a class="headerlink" href="#using-other-fastdds-capabilities-with-xml" title="Lien permanent vers ce titre"></a></h2>
<p>Bien que nous ayons créé un nœud avec deux éditeurs avec une configuration différente, il n’est pas facile de vérifier qu’ils se comportent différemment. Maintenant que les bases des profils XML ont été couvertes, utilisons-les pour configurer quelque chose qui a un effet visuel sur les nœuds. Plus précisément, un nombre maximal d’abonnés correspondants sur l’un des éditeurs et une définition de partition sur l’autre seront définis. Notez que ce ne sont que des exemples très simples parmi tous les attributs de configuration qui peuvent être réglés sur <code class="docutils literal notranslate"><span class="pre">rmw_fastrtps</span></code> via des fichiers XML. Veuillez vous référer à <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/latest/fastdds/xml_configuration/xml_configuration.html#xml-profiles">*Fast DDS* documentation</a> pour voir la liste complète des attributs qui peut être configuré via des fichiers XML.</p>
<div class="section" id="limiting-the-number-of-matching-subscribers">
<h3><a class="toc-backref" href="#id12">Limiter le nombre d’abonnés correspondants</a><a class="headerlink" href="#limiting-the-number-of-matching-subscribers" title="Lien permanent vers ce titre"></a></h3>
<p>Ajoutez un nombre maximum d’abonnés correspondants au profil d’éditeur <code class="docutils literal notranslate"><span class="pre">/async_topic</span></code>. Ça devrait ressembler à ça:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- publisher profile for topic async_topic --&gt;</span>
<span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;/async_topic&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;qos&gt;</span>
<span class="w">        </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">            </span><span class="nt">&lt;kind&gt;</span>ASYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">        </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">    </span><span class="nt">&lt;/qos&gt;</span>
<span class="w">    </span><span class="nt">&lt;matchedSubscribersAllocation&gt;</span>
<span class="w">        </span><span class="nt">&lt;initial&gt;</span>0<span class="nt">&lt;/initial&gt;</span>
<span class="w">        </span><span class="nt">&lt;maximum&gt;</span>1<span class="nt">&lt;/maximum&gt;</span>
<span class="w">        </span><span class="nt">&lt;increment&gt;</span>1<span class="nt">&lt;/increment&gt;</span>
<span class="w">    </span><span class="nt">&lt;/matchedSubscribersAllocation&gt;</span>
<span class="nt">&lt;/publisher&gt;</span>
</pre></div>
</div>
<p>Le nombre d’abonnés correspondants est limité à un.</p>
<p>Ouvrez maintenant trois terminaux et n’oubliez pas de sourcer les fichiers d’installation et de définir les variables d’environnement requises. Sur le premier terminal, exécutez le nœud éditeur et le nœud abonné sur les deux autres. Vous devriez voir que seul le premier nœud d’abonné reçoit les messages des deux sujets. Le second n’a pas pu terminer le processus de correspondance dans le <code class="docutils literal notranslate"><span class="pre">/async_topic</span></code> car l’éditeur l’en a empêché, car il avait déjà atteint son maximum d’éditeurs correspondants. Par conséquent, seuls les messages du <code class="docutils literal notranslate"><span class="pre">/sync_topic</span></code> vont être reçus dans ce troisième terminal :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1613127657.088860890] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 18&#39;</span>
<span class="go">[INFO] [1613127657.588896594] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 19&#39;</span>
<span class="go">[INFO] [1613127658.088849401] [sync_async_subscriber]: I heard: &#39;SYNC: Hello, world! 20&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="using-partitions-within-the-topic">
<h3><a class="toc-backref" href="#id13">Utilisation de partitions dans le sujet</a><a class="headerlink" href="#using-partitions-within-the-topic" title="Lien permanent vers ce titre"></a></h3>
<p>La fonction de partitions peut être utilisée pour contrôler quels éditeurs et abonnés échangent des informations dans le même sujet.</p>
<p>Les partitions introduisent un concept de niveau d’isolation d’entité logique à l’intérieur de l’isolation physique induite par un ID de domaine. Pour qu’un éditeur puisse communiquer avec un abonné, il doit appartenir au moins à une partition commune. Les partitions représentent un autre niveau pour séparer les éditeurs et les abonnés au-delà du domaine et du sujet. Contrairement au domaine et au sujet, un point de terminaison peut appartenir à plusieurs partitions en même temps. Pour que certaines données soient partagées sur différents domaines ou sujets, il doit y avoir un éditeur différent pour chacun, partageant son propre historique des modifications. Cependant, un seul éditeur peut partager le même échantillon de données sur différentes partitions à l’aide d’un seul changement de données de sujet, réduisant ainsi la surcharge du réseau.</p>
<p>Changeons l’éditeur <code class="docutils literal notranslate"><span class="pre">/sync_topic</span></code> pour partitionner <code class="docutils literal notranslate"><span class="pre">part1</span></code> et créons un nouvel abonné <code class="docutils literal notranslate"><span class="pre">/sync_topic</span></code> qui utilise la partition <code class="docutils literal notranslate"><span class="pre">part2</span></code>. Leurs profils devraient maintenant ressembler à ceci :</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- publisher profile for topic sync_topic --&gt;</span>
<span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;/sync_topic&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;qos&gt;</span>
<span class="w">        </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">            </span><span class="nt">&lt;kind&gt;</span>SYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">        </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;partition&gt;</span>
<span class="w">            </span><span class="nt">&lt;names&gt;</span>
<span class="w">                </span><span class="nt">&lt;name&gt;</span>part1<span class="nt">&lt;/name&gt;</span>
<span class="w">            </span><span class="nt">&lt;/names&gt;</span>
<span class="w">        </span><span class="nt">&lt;/partition&gt;</span>
<span class="w">    </span><span class="nt">&lt;/qos&gt;</span>
<span class="nt">&lt;/publisher&gt;</span>

<span class="cm">&lt;!-- subscriber profile for topic sync_topic --&gt;</span>
<span class="nt">&lt;subscriber</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;/sync_topic&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;qos&gt;</span>
<span class="w">        </span><span class="nt">&lt;partition&gt;</span>
<span class="w">            </span><span class="nt">&lt;names&gt;</span>
<span class="w">                </span><span class="nt">&lt;name&gt;</span>part2<span class="nt">&lt;/name&gt;</span>
<span class="w">            </span><span class="nt">&lt;/names&gt;</span>
<span class="w">        </span><span class="nt">&lt;/partition&gt;</span>
<span class="w">    </span><span class="nt">&lt;/qos&gt;</span>
<span class="nt">&lt;/subscriber&gt;</span>
</pre></div>
</div>
<p>Assurez-vous également de supprimer le profil d’abonné « default_subscriber ». Ouvrez deux terminaux. N’oubliez pas de sourcer les fichiers d’installation et de définir les variables d’environnement requises. Sur le premier terminal, exécutez le nœud éditeur et le nœud abonné sur l’autre. Vous devriez voir que seuls les messages <code class="docutils literal notranslate"><span class="pre">/async_topic</span></code> parviennent à l’abonné. L’abonné <code class="docutils literal notranslate"><span class="pre">/sync_topic</span></code> ne reçoit pas les données car elles se trouvent dans une partition différente de l’éditeur correspondant.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612972054.995410057] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 10&#39;</span>
<span class="go">[INFO] [1612972055.995396561] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 11&#39;</span>
<span class="go">[INFO] [1612972056.995473953] [sync_async_subscriber]: I heard: &#39;ASYNC: Hello, world! 12&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-a-service-and-a-client">
<h2><a class="toc-backref" href="#id14">Configurer un service et un client</a><a class="headerlink" href="#configuring-a-service-and-a-client" title="Lien permanent vers ce titre"></a></h2>
<p>Les services et les clients ont chacun un éditeur et un abonné, qui communiquent via deux sujets différents. Par exemple, pour un service nommé <code class="docutils literal notranslate"><span class="pre">ping</span></code> il y a :</p>
<ul class="simple">
<li><p>Un abonné au service écoutant les requêtes sur <code class="docutils literal notranslate"><span class="pre">/rq/ping</span></code>.</p></li>
<li><p>Un éditeur de service envoyant des réponses sur <code class="docutils literal notranslate"><span class="pre">/rr/ping</span></code>.</p></li>
<li><p>Un éditeur client envoyant des requêtes sur <code class="docutils literal notranslate"><span class="pre">/rq/ping</span></code>.</p></li>
<li><p>Un abonné client écoutant les réponses sur <code class="docutils literal notranslate"><span class="pre">/rr/ping</span></code>.</p></li>
</ul>
<p>Bien que vous puissiez utiliser ces noms de rubrique pour définir les profils de configuration sur le XML, vous pouvez parfois souhaiter appliquer le même profil à tous les services ou clients sur un nœud. Au lieu de copier le même profil avec tous les noms de sujets générés pour tous les services, vous pouvez simplement créer une paire de profils d’éditeur et d’abonné nommée <code class="docutils literal notranslate"><span class="pre">service</span></code>. La même chose peut être faite pour les clients créant une paire nommée <code class="docutils literal notranslate"><span class="pre">client</span></code>.</p>
<div class="section" id="create-the-nodes-with-the-service-and-client">
<h3><a class="toc-backref" href="#id15">Créer les nœuds avec le service et le client</a><a class="headerlink" href="#create-the-nodes-with-the-service-and-client" title="Lien permanent vers ce titre"></a></h3>
<p>Commencez à créer le nœud avec le service. Ajoutez un nouveau fichier source nommé <code class="docutils literal notranslate"><span class="pre">src/ping_service.cpp</span></code> sur votre package avec le contenu suivant :</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;example_interfaces/srv/trigger.hpp&quot;</span>

<span class="cm">/**</span>
<span class="cm"> * Service action: responds with success=true and prints the request on the console</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">ping</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">::</span><span class="n">Response</span><span class="o">&gt;</span><span class="w"> </span><span class="n">response</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// The request data is unused</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Build the response</span>
<span class="w">    </span><span class="n">response</span><span class="o">-&gt;</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Log to the console</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_server&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Incoming request&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_server&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Sending back response&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create the node and the service</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;ping_server&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Service</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_service</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;ping&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ping</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Log that the service is ready</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_server&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Ready to serve.&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// run the node</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Créez le client dans un fichier nommé <code class="docutils literal notranslate"><span class="pre">src/ping_client.cpp</span></code> avec le contenu suivant :</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;chrono&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;example_interfaces/srv/trigger.hpp&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="o">::</span><span class="nn">chrono_literals</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create the node and the client</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Client</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_client</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;ping&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create a request</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">example_interfaces</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">Trigger</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Wait for the service to be available</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="o">-&gt;</span><span class="n">wait_for_service</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">RCLCPP_ERROR</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Interrupted while waiting for the service. Exiting.&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Service not available, waiting again...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Now that the service is available, send the request</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Sending request&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="o">-&gt;</span><span class="n">async_send_request</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Wait for the result and log it to the console</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_until_future_complete</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="o">==</span>
<span class="w">        </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">FutureReturnCode</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Response received&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_ERROR</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ping_client&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Failed to call service ping&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ouvrez le fichier <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> et ajoutez deux nouveaux exécutables <code class="docutils literal notranslate"><span class="pre">ping_service</span></code> et <code class="docutils literal notranslate"><span class="pre">ping_client</span></code> :</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">example_interfaces</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>

<span class="nb">add_executable</span><span class="p">(</span><span class="s">ping_service</span><span class="w"> </span><span class="s">src/ping_service.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">ping_service</span><span class="w"> </span><span class="s">example_interfaces</span><span class="w"> </span><span class="s">rclcpp</span><span class="p">)</span>

<span class="nb">add_executable</span><span class="p">(</span><span class="s">ping_client</span><span class="w"> </span><span class="s">src/ping_client.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">ping_client</span><span class="w"> </span><span class="s">example_interfaces</span><span class="w"> </span><span class="s">rclcpp</span><span class="p">)</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">    </span><span class="s">ping_service</span>
<span class="w">    </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span>
<span class="w">    </span><span class="s">ping_client</span>
<span class="w">    </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>Enfin, construisez le package.</p>
</div>
<div class="section" id="create-the-xml-profiles-for-the-service-and-client">
<h3><a class="toc-backref" href="#id16">Créer les profils XML pour le service et le client</a><a class="headerlink" href="#create-the-xml-profiles-for-the-service-and-client" title="Lien permanent vers ce titre"></a></h3>
<p>Créez un fichier avec le nom <code class="docutils literal notranslate"><span class="pre">ping.xml</span></code> avec le contenu suivant :</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;profiles</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.eprosima.com/XMLSchemas/fastRTPS_Profiles&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- default publisher profile --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;default_publisher&quot;</span><span class="w"> </span><span class="na">is_default_profile=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- default subscriber profile --&gt;</span>
<span class="w">    </span><span class="nt">&lt;subscriber</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;default_subscriber&quot;</span><span class="w"> </span><span class="na">is_default_profile=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">    </span><span class="nt">&lt;/subscriber&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- service publisher is SYNC --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;service&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">        </span><span class="nt">&lt;qos&gt;</span>
<span class="w">            </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">                </span><span class="nt">&lt;kind&gt;</span>SYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">            </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/qos&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- client publisher is ASYNC --&gt;</span>
<span class="w">    </span><span class="nt">&lt;publisher</span><span class="w"> </span><span class="na">profile_name=</span><span class="s">&quot;client&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;historyMemoryPolicy&gt;</span>DYNAMIC<span class="nt">&lt;/historyMemoryPolicy&gt;</span>
<span class="w">        </span><span class="nt">&lt;qos&gt;</span>
<span class="w">            </span><span class="nt">&lt;publishMode&gt;</span>
<span class="w">                </span><span class="nt">&lt;kind&gt;</span>ASYNCHRONOUS<span class="nt">&lt;/kind&gt;</span>
<span class="w">            </span><span class="nt">&lt;/publishMode&gt;</span>
<span class="w">        </span><span class="nt">&lt;/qos&gt;</span>
<span class="w">    </span><span class="nt">&lt;/publisher&gt;</span>

<span class="nt">&lt;/profiles&gt;</span>
</pre></div>
</div>
<p>Ce fichier de configuration définit le mode de publication sur <code class="docutils literal notranslate"><span class="pre">SYNCHRONOUS</span></code> sur le service et sur <code class="docutils literal notranslate"><span class="pre">ASYNCHRONOUS</span></code> sur le client. Notez que nous ne définissons que les profils d’éditeur pour le service et le client, mais des profils d’abonnés peuvent également être fournis.</p>
</div>
<div class="section" id="execute-the-nodes">
<h3><a class="toc-backref" href="#id17">Exécuter les nœuds</a><a class="headerlink" href="#execute-the-nodes" title="Lien permanent vers ce titre"></a></h3>
<p>Ouvrez deux terminaux et sourcez les fichiers de configuration sur chacun d’eux. Définissez ensuite les variables d’environnement requises pour le XML à charger :</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-TGludXg=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-TGludXg=" name="TGludXg=" role="tab" tabindex="0">Linux</button><button aria-controls="panel-3-bWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="-1">macOS</button><button aria-controls="panel-3-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-3-TGludXg=" class="sphinx-tabs-panel group-tab" id="panel-3-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/ping.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-bWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">export RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">export FASTRTPS_DEFAULT_PROFILES_FILE=path/to/ping.xml</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">SET RMW_IMPLEMENTATION=rmw_fastrtps_cpp</span>
<span class="go">SET RMW_FASTRTPS_USE_QOS_FROM_XML=1</span>
<span class="go">SET FASTRTPS_DEFAULT_PROFILES_FILE=path/to/ping.xml</span>
</pre></div>
</div>
</div></div>
<p>Sur le premier terminal, exécutez le nœud de service.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run sync_async_node_example_cpp ping_service</span>
</pre></div>
</div>
<p>Vous devriez voir le service en attente de demandes :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612977403.805799037] [ping_server]: Ready to serve</span>
</pre></div>
</div>
<p>Sur le deuxième terminal, exécutez le nœud client.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run sync_async_node_example_cpp ping_client</span>
</pre></div>
</div>
<p>Vous devriez voir le client envoyer la requête et recevoir la réponse :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612977404.805799037] [ping_client]: Sending request</span>
<span class="go">[INFO] [1612977404.825473835] [ping_client]: Response received</span>
</pre></div>
</div>
<p>Dans le même temps, la sortie dans la console du serveur a été mise à jour :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[INFO] [1612977403.805799037] [ping_server]: Ready to serve</span>
<span class="go">[INFO] [1612977404.807314904] [ping_server]: Incoming request</span>
<span class="go">[INFO] [1612977404.836405125] [ping_server]: Sending back response</span>
</pre></div>
</div>
</div>
</div>
</div>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="Allocator-Template-Tutorial.html" class="btn btn-neutral float-left" title="Implémentation d’un répartiteur de mémoire personnalisé" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="Recording-A-Bag-From-Your-Own-Node-CPP.html" class="btn btn-neutral float-right" title="Enregistrer un sac à partir d’un nœud (C++)" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Open Robotics.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>